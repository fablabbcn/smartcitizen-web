!function(){"use strict";angular.module("app.components",[])}(),function(){"use strict";angular.module("app.components").factory("User",["COUNTRY_CODES",function(t){function e(e){this.id=e.id,this.username=e.username,this.avatar=e.avatar,this.kits=e.devices,this.url=e.url,this.city=e.location.city,this.country=t[e.location.country_code]}return e}])}(),function(){"use strict";angular.module("app.components").factory("NonAuthUser",["User",function(t){function e(e){t.call(this,e)}return e.prototype=Object.create(t.prototype),e.prototype.constructor=t,e}])}(),function(){"use strict";angular.module("app.components").factory("AuthUser",["User",function(t){function e(e){t.call(this,e),this.email=e.email,this.role=e.role,this.key="23243532423524234",this.macAddress=e.macAddress}return e.prototype=Object.create(t.prototype),e.prototype.constructor=t,e}])}(),function(){"use strict";angular.module("app.components").factory("Sensor",["sensorUtils",function(t){function e(e,n){this.name=t.getSensorName(e),this.id=e.id,this.unit=t.getSensorUnit(this.name),this.value=t.getSensorValue(e),this.prevValue=t.getSensorPrevValue(e),this.icon=t.getSensorIcon(this.name),this.arrow=t.getSensorArrow(this.value,this.prevValue),this.color=t.getSensorColor(this.name),this.description=t.getSensorDescription(this.id,n)}return e}])}(),function(){"use strict";angular.module("app.components").factory("SearchResult",["searchUtils",function(t){function e(e){"Location"===e.type||(this.id=e.id,this.type=e.type,this.name=t.parseName(e),this.location=t.parseLocation(e),this.image="User"===e.type?"./assets/images/avatar.svg":"./assets/images/kit.svg")}return e}])}(),function(){"use strict";angular.module("app.components").factory("Marker",["device","markerUtils",function(t,e){function n(t){this.lat=e.parseCoordinates(t).lat,this.lng=e.parseCoordinates(t).lng,this.message='<div class="popup"><div class="popup_top '+e.classify(e.parseType(t))+'"><p class="popup_name">'+e.parseName(t)+'</p><p class="popup_type">'+e.parseType(t)+'</p><p class="popup_time"><md-icon class="popup_icon" md-svg-src="./assets/images/update_icon.svg"></md-icon>'+e.parseTime(t)+'</p></div><div class="popup_bottom"><p class="popup_location"><md-icon class="popup_icon" md-svg-src="./assets/images/location_icon_dark.svg"></md-icon>'+e.parseLocation(t)+'</p><div class="popup_labels">'+a(t)+"</div></div></div>",this.icon=e.getIcon(e.parseLabels(t)),this.layer="realworld",this.focus=!1,this.myData={id:e.parseId(t),labels:e.parseLabels(t)}}function a(t){var n=e.parseLabels(t);return _.reduce(n,function(t,e){return t.concat("<span>"+e+"</span>")},"")}return n}])}(),function(){"use strict";angular.module("app.components").factory("PreviewKit",["Kit","kitUtils",function(t,e){function n(n){t.call(this,n),this.state=e.parseState(n)}return n.prototype=Object.create(t.prototype),n.prototype.constructor=t,n}])}(),function(){"use strict";angular.module("app.components").factory("Kit",["Sensor","kitUtils",function(t,e){function n(t){this.id=t.id,this.name=t.name,this.type=e.parseType(t),this.location=e.parseLocation(t),this.avatar=e.parseAvatar(t,this.type),this.labels=e.parseLabels(t)}return n}])}(),function(){"use strict";angular.module("app.components").factory("HasSensorKit",["Kit",function(t){function e(e){t.call(this,e),this.data=e.data.sensors,this.longitude=e.data.location.longitude,this.latitude=e.data.location.latitude}return e.prototype=Object.create(t.prototype),e.prototype.constructor=t,e.prototype.sensorsHasData=function(){var t=this.data.map(function(t){return t.value});return _.some(t,function(t){return!!t})},e}])}(),function(){"use strict";angular.module("app.components").factory("FullKit",["Kit","Sensor","kitUtils","utils",function(t,e,n,a){function o(e){t.call(this,e),this.version=n.parseVersion(e),this.lastTime=moment(n.parseTime(e)).fromNow(),this["class"]=n.classify(n.parseType(e)),this.description=e.description,this.owner=n.parseOwner(e),this.data=e.data.sensors,this.latitude=e.data.location.latitude,this.longitude=e.data.location.longitude,this.time=moment(a.parseKitTime(e)).fromNow()}return o.prototype=Object.create(t.prototype),o.prototype.constructor=o,o.prototype.getSensors=function(t,n){var a=this.data.map(function(n){return new e(n,t)});return"compare"===n.type&&a.unshift({name:"NONE",color:"white",id:-1}),a.reduce(function(t,e,a,o){return"BATTERY"===e.name&&(o.splice(a,1),"main"===n.type?(t[0]=o,t[1]=e):"compare"===n.type&&(t=o)),t},[])},o}])}(),function(){"use strict";function t(t,e,n){function a(t){var e={kitName:t.device.name,kitType:i(t),kitLastTime:moment(l(t)).fromNow(),kitLocation:o(t),kitLabels:s(t),kitClass:r(i(t))};return e}function o(t){var e="",n=t.data.location.city,a=t.data.location.country;return n&&(e+=n),a&&(e+=", "+a),e}function s(t){return{status:t.status,exposure:t.data.location.exposure}}function i(t){var e;return new RegExp("sck","i").test(t.kit.name)&&(e="SmartCitizen Kit"),e}function r(t){return t?t.toLowerCase().split(" ").join("_"):""}function l(t){return t.updated_at}function c(t){return moment(t.recorded_at).format("")}function u(t){return moment(t).format("YYYY-MM-DDThh:mm:ss")+"Z"}function d(){}function m(a){var o=n.defer(),s=0,i=[];return a.forEach(function(n,r){t.getDevice(n).then(function(t){i[r]=new e(t),s++,a.length===s&&o.resolve(i)})}),o.promise}var p={parseKit:a,parseKitTime:l,parseSensorTime:c,convertTime:u,getTimeDifferenceInDays:d,getOwnerKits:m};return p}angular.module("app.components").factory("utils",t),t.$inject=["device","PreviewKit","$q"]}(),function(){"use strict";function t(){function t(t){return"admin"===t.role}function e(t,e){return t===e.id}var n={isAdmin:t,isAuthUser:e};return n}angular.module("app.components").factory("userUtils",t)}(),function(){"use strict";function t(){function t(t,e){if(!e)return t;var n;return"ms"===e?n=t:"s"===e?n=t/1e3:"m"===e?n=t/1e3/60:"h"===e?n=t/1e3/60/60:"d"===e&&(n=t/1e3/60/60/24),n}function e(t){return new Date(t).getTime()}function n(t,e){return moment(e).diff(moment(t),"days")}function a(n,a){return n=e(n),t(n,a)}function o(){return(new Date).getTime()}function s(){return e(o()-6048e5)}function i(t,e){return t=moment(t),e=moment(e),t.startOf("day").isSame(e.startOf("day"))?!0:!1}var r={getSecondsFromDate:e,getCurrentRange:n,getToday:o,getSevenDaysAgo:s,getDateIn:t,parseTime:a,isSameDay:i};return r}angular.module("app.components").factory("timeUtils",t)}(),function(){"use strict";function t(t){function e(e,n){var a,o=t.getCurrentRange(e,n,{format:"d"});return 1>=o?a="1h":7>=o?a="1h":o>7&&(a="1d"),a}function n(t){var e,n=t.name,a=t.description;return e=new RegExp("custom circuit","i").test(a)?n:new RegExp("noise","i").test(a)?"SOUND":new RegExp("light","i").test(a)?"LIGHT":new RegExp("wifi","i").test(a)?"NETWORKS":new RegExp("co","i").test(a)?"CO":new RegExp("no2","i").test(a)?"NO2":a,e.toUpperCase()}function a(t){var e;switch(t){case"TEMPERATURE":e="Â°C";break;case"LIGHT":e="LUX";break;case"SOUND":e="DB";break;case"HUMIDITY":case"BATTERY":e="%";break;case"CO":case"NO2":e="Kâ„¦";break;case"NETWORKS":e="#";break;case"SOLAR PANEL":e="V";break;default:e="N/A"}return e}function o(t){var e=t.value;return e?(e=e.toString(),-1!==e.indexOf(".")&&(e=e.slice(0,e.indexOf(".")+3))):e="N/A",e}function s(t){var e=t.prev_value;return e&&e.toString()||0}function i(t){switch(t){case"TEMPERATURE":return"./assets/images/temperature_icon.svg";case"HUMIDITY":return"./assets/images/humidity_icon.svg";case"LIGHT":return"./assets/images/light_icon.svg";case"SOUND":return"./assets/images/sound_icon.svg";case"CO":return"./assets/images/co_icon.svg";case"NO2":return"./assets/images/no2_icon.svg";case"NETWORKS":return"./assets/images/networks_icon.svg";case"BATTERY":return"./assets/images/battery_icon.svg";case"SOLAR PANEL":return"./assets/images/solar_panel_icon.svg";default:return"./assets/images/avatar.svg"}}function r(t,e){return t=parseInt(t)||0,e=parseInt(e)||0,t>e?"./assets/images/arrow_up_icon.svg":e>t?"./assets/images/arrow_down_icon.svg":"./assets/images/equal_icon.svg"}function l(t){switch(t){case"TEMPERATURE":return"#ffc107";case"HUMIDITY":return"#4fc3f7";case"LIGHT":return"#ffee58";case"SOUND":return"#f06292";case"CO":return"#4caf50";case"NO2":return"#8bc34a";case"NETWORKS":return"#9575cd";case"SOLAR PANEL":return"#fff9c4";default:return"black"}}function c(t,e){return _(e).chain().find(function(e){return e.id===t}).value().measurement.description.slice(0,140)}var u={getRollup:e,getSensorName:n,getSensorUnit:a,getSensorValue:o,getSensorPrevValue:s,getSensorIcon:i,getSensorArrow:r,getSensorColor:l,getSensorDescription:c};return u}angular.module("app.components").factory("sensorUtils",t),t.$inject=["timeUtils"]}(),function(){"use strict";function t(){function t(t){var e="";return t.city&&(e+=t.city),t.country&&(e+=", "+t.country),e}function e(t){var e="User"===t.type?t.username:t.name;return e?e:"No name"}var n={parseLocation:t,parseName:e};return n}angular.module("app.components").factory("searchUtils",t),t.$inject=[]}(),function(){"use strict";function t(t,e,n,a){function o(e){var n,a=t.getGenericKitData(),o=a[e.kit_id],s=o&&o.name;return new RegExp("sck","i").test(s)&&(n="SmartCitizen Kit"),n}function s(t){var e="",a=t.city,o=t.country_code,s=n[o];return a&&(e+=a),s&&(e+=", "+s),e}function i(t){return t.system_tags}function r(t){return{lat:t.latitude,lng:t.longitude}}function l(t){return t.id}function c(t){var e;return e=u(t,"offline")?a.smartCitizenOffline:a.smartCitizenOnline}function u(t,e){return _.some(t,function(t){return t===e})}function d(t){return t.name.length<=41?t.name:t.name.slice(0,35).concat(" ... ")}function m(t){var e=t.data&&t.data[""];return e?moment(e).fromNow():"No time"}var p={parseType:o,parseLocation:s,parseLabels:i,parseCoordinates:r,parseId:l,getIcon:c,parseName:d,parseTime:m};return _.defaults(p,e),p}angular.module("app.components").factory("markerUtils",t),t.$inject=["device","kitUtils","COUNTRY_CODES","MARKER_ICONS"]}(),function(){"use strict";function t(){function t(t,e){var n={};return t.indoor||t.outdoor||(n[e.exposure]=!0),t.online||t.offline||(n[e.status]=!0),n}function e(t){var e={};return t.indoor&&t.outdoor||(e.exposure=t.indoor?"indoor":"outdoor"),t.online&&t.offline||(e.status=t.online?"online":"offline"),e}function n(t,e){return"indoor"===e||"outdoor"===e?t.indoor&&t.outdoor:"online"===e||"offline"===e?t.online&&t.offline:void 0}var a={getDefaultFilters:t,setDefaultFilters:e,canFilterBeRemoved:n};return a}angular.module("app.components").factory("mapUtils",t),t.$inject=[]}(),function(){"use strict";function t(t){function e(t){var e="",n=t.data.location.city,a=t.data.location.country;return n&&(e+=n),a&&(e+=", "+a),e}function n(t){return t.system_tags}function a(t){var e;return new RegExp("sck","i").test(t.kit.name)&&(e="SmartCitizen Kit"),e}function o(t){return t?t.toLowerCase().split(" ").join("_"):""}function s(t){return t.updated_at}function i(t){return t.kit.name.match(/[0-9]+.?[0-9]*/)[0]}function r(e){return{id:e.owner.id,username:e.owner.username,kits:e.owner.device_ids,city:e.owner.location.city,country:t[e.owner.location.country_code],url:e.owner.url,avatar:e.owner.avatar}}function l(t){var e=c(t),n=o(e);return{name:e,className:n}}function c(t){return t.state.replace("_"," ")}function u(){return"./assets/images/sckit_avatar.jpg"}function d(t){return moment(t.recorded_at).format("")}function m(t,e){return _.some(t,function(t){return t.id===e})}var p={parseLocation:e,parseLabels:n,parseType:a,classify:o,parseTime:s,parseVersion:i,parseOwner:r,parseState:l,parseAvatar:u,belongsToUser:m,parseSensorTime:d};return p}angular.module("app.components").factory("kitUtils",t),t.$inject=["COUNTRY_CODES"]}(),function(){"use strict";function t(t,e,n,a,o,s,i,r,l){function c(t){"all"===t&&(t=void 0),d.status=t}function u(){var t=document.body.clientHeight/4*3;angular.element(".profile_content").css("min-height",t+"px")}var d=this,m=o,p=s;d.status=void 0,d.user=m,d.kits=p,d.filterKits=c,t.$on("loggedIn",function(){var t=parseInt(e.id),a=i.getCurrentUser().data;r.isAuthUser(t,a)&&n.path("/profile")}),l(function(){u()},500)}angular.module("app.components").controller("UserProfileController",t),t.$inject=["$scope","$stateParams","$location","utils","userData","kitsData","auth","userUtils","$timeout"]}(),function(){"use strict";function t(){return{scope:{show:"="},restrict:"A",controller:"SignupController",controllerAs:"vm",templateUrl:"app/components/signup/signup.html"}}angular.module("app.components").directive("signup",t)}(),function(){"use strict";function t(t,e){function n(){e.show({hasBackdrop:!0,controller:"SignupDialogController",templateUrl:"app/components/signup/signupModal.html",clickOutsideToClose:!0}).then(function(){})["finally"](function(){})}var a=this;a.showSignup=n,t.$on("showSignup",function(){n()})}angular.module("app.components").controller("SignupController",t),t.$inject=["$scope","$mdDialog"]}(),function(){"use strict";function t(){function t(){}return{link:t,scope:!0,restrict:"E",templateUrl:"app/components/search/search.html",controller:"SearchController",controllerAs:"vm"}}angular.module("app.components").directive("search",t)}(),function(){"use strict";function t(t,e,n,a){function o(){}function s(t){"User"===t.type?a.path("/users/"+t.id):"Device"===t.type&&a.path("/kits/"+t.id)}function i(t){return e.globalSearch(t).then(function(t){return 0===t.length?(angular.element(document.body).css("overflow","auto"),t):(angular.element(document.body).css("overflow","hidden"),t.map(function(t){return new n(t)}))})}var r=this;r.searchTextChange=o,r.selectedItemChange=s,r.querySearch=i,r.isIconWhite=!0,t.$on("removeNav",function(){t.$apply(function(){r.isIconWhite=!1})}),t.$on("addNav",function(){t.$apply(function(){r.isIconWhite=!0})})}angular.module("app.components").controller("SearchController",t),t.$inject=["$scope","search","SearchResult","$location"]}(),function(){"use strict";function t(t,e,n,a,o){function s(){i()}function i(){o.getResetPassword(e.code).then(function(){l.showForm=!0})["catch"](function(){a.error("Wrong url"),n.path("/")})}function r(t){return l.waitingFromServer=!0,l.errors=void 0,t.newPassword!==t.confirmPassword?void(l.isDifferent=!0):(l.isDifferent=!1,void o.patchResetPassword(e.code,{password:t.newPassword}).then(function(){a.success("Your data was updated successfully"),n.path("/profile")})["catch"](function(t){a.error("Your data wasn't updated"),console.log("err",t),l.errors=t.data.errors})["finally"](function(){l.waitingFromServer=!1}))}var l=this;l.showForm=!1,l.form={},l.isDifferent=!1,l.answer=r,s()}angular.module("app.components").controller("PasswordResetController",t),t.$inject=["$mdDialog","$stateParams","$location","alert","auth"]}(),function(){"use strict";function t(t,e,n){function a(){o.waitingFromServer=!0,o.errors=void 0;var a={username:o.username};t.recoverPassword(a).then(function(){e.success("You were sent an email to recover your password"),n.hide()})["catch"](function(t){o.errors=t.data.errors,o.errors&&e.error("That email/username doesn't exist")})["finally"](function(){o.waitingFromServer=!1})}var o=this;o.waitingFromServer=!1,o.errors=void 0,o.recoverPassword=a}angular.module("app.components").controller("PasswordRecoveryController",t),t.$inject=["auth","alert","$mdDialog"]}(),function(){"use strict";function t(t,e,n,a,o,s,i,r,l,c,u,d){function m(t){"all"===t&&(t=void 0),S.kitStatus=t}function p(t){"all"===t&&(t=void 0),S.toolType=t}function f(t){t.country&&_.each(c,function(e,n){return e===t.country?void(t.country_code=n):void 0}),s.updateUser(t).then(function(t){var e=new o(t);_.extend(S.user,e),S.errors={},l.success("User updated")})["catch"](function(t){l.error("User could not be updated "),S.errors=t.data.errors})}function g(){s.removeUser().then(function(){})}function v(t){var e=angular.element(".myProfile_tab_icon");_.each(e,function(t){h(t)});var n=e[t];angular.element(n).find(".stroke_container").css({stroke:"white","stroke-width":"0.01px"}),angular.element(n).find(".fill_container").css("fill","white")}function h(t){t=angular.element(t),t.find(".stroke_container").css({stroke:"none"}),t.find(".fill_container").css("fill","#82A7B0")}function y(){var t=document.body.clientHeight/4*3;angular.element(".profile_content").css("min-height",t+"px")}function k(t){return _.filter(c,b(t))}function b(t){return t=t.toLowerCase(),function(e){return e=e.toLowerCase(),-1!==e.indexOf(t)}}function w(t){t&&t.length&&d.getCredentials(t[0].name).then(function(e){d.uploadFile(t[0],e.key,e.policy,e.signature).progress(function(){}).success(function(){S.user.avatar=d.getImageURL(e.key)})})}var S=this;S.highlightIcon=v,S.unhighlightIcon=h,S.formUser={avatar:null},S.getCountries=k,n&&(S.user=n,_.defaults(S.formUser,S.user),S.searchText=S.formUser.country),S.kits=a,S.kitStatus=void 0,S.filteredKits=[],S.dropdownSelected=void 0,S.dropdownOptions=[{text:"SET UP",value:"1"},{text:"EDIT",value:"2"}],S.tools=[{type:"documentation",title:"How to connect your Smart Citizen Kit tutorial",description:"Adding a Smart Citizen Kit",avatar:"",href:"http://www.google.com"},{type:"documentation",title:"Download the latest SCK Firmware",description:"Github version of the firmware",avatar:""},{type:"documentation",title:"RESTful API Documentation",description:"API Docs",avatar:""},{type:"community",title:"Smart Citizen Forum",description:"Your feedback is important for us",avatar:""},{type:"documentation",title:"SCK Repository Documentation",description:"Fork the project",avatar:""},{type:"social",title:"Like us on Facebook",description:"Follow our news on Facebook",avatar:""},{type:"social",title:"Follow us on Twitter",description:"Discover the weather and your smart connections on Twitter",avatar:""},{type:"social",title:"Be our friend on Google+",description:"Get informed about latest news of Smart Citizen",avatar:""}],S.toolType=void 0,S.filteredTools=[],S.filterKits=m,S.filterTools=p,S.updateUser=f,S.removeUser=g,S.uploadAvatar=w,t.$on("loggedOut",function(){e.path("/")}),u(function(){v(0),y()},500)}angular.module("app.components").controller("MyProfileController",t),t.$inject=["$scope","$location","userData","kitsData","AuthUser","user","auth","utils","alert","COUNTRY_CODES","$timeout","file"]}(),function(){"use strict";angular.module("app.components")}(),function(){"use strict";function t(t,e,n,a,o,s,i,r,l,c){function u(){d()}function d(){var t=_.every(y.filterData,function(t){return t});y.allFiltersSelected=t?!0:!1}function m(){r.show({hasBackdrop:!0,controller:"MapFilterDialogController",templateUrl:"app/components/map/mapFilterPopup.html",clickOutsideToClose:!0,locals:{filterData:y.filterData}}).then(function(t,e){_.extend(y.filterData,t),_.extend(w,e),g(t),d()})}function p(t){c.canFilterBeRemoved(y.filterData,t)&&(y.filterData[t]=!1,_.extend(w,c.setDefaultFilters(y.filterData,w)),g(y.filterData),d())}function f(t){return o.filter(function(e){var n=e.myData.labels;return _.every(n,function(e){return t[e]})})}function g(e){y.markers=[],n(function(){t.$apply(function(){y.markers=f(e)})})}var v,h,y=this,k=o[0],b=_.indexBy(o,function(t){return t.myData.id});y.markers=o,y.currentMarker=i.getCurrentMarker(),y.tiles={url:"https://api.tiles.mapbox.com/v4/mapbox.streets-basic/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoidG9tYXNkaWV6IiwiYSI6ImRTd01HSGsifQ.loQdtLNQ8GJkJl2LUzzxVg"},y.layers={baselayers:{osm:{name:"OpenStreetMap",type:"xyz",url:"https://api.tiles.mapbox.com/v4/mapbox.streets-basic/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoidG9tYXNkaWV6IiwiYSI6ImRTd01HSGsifQ.loQdtLNQ8GJkJl2LUzzxVg"}},overlays:{realworld:{name:"Real world data",type:"markercluster",visible:!0,layerOptions:{showCoverageOnHover:!1}}}},y.center={lat:k.lat,lng:k.lng,zoom:12},y.defaults={scrollWheelZoom:!1},y.events={map:{enable:["dragend","zoomend","moveend","popupopen","popupclose","mousedown","dblclick","click","touchstart"],logic:"broadcast"}},t.$on("leafletDirectiveMarker.click",function(t,n){y.center.lat=n.leafletEvent.latlng.lat,y.center.lng=n.leafletEvent.latlng.lng,v="map";var a=n.leafletEvent.target.options.myData.id;e.go("layout.home.kit",{id:a})}),t.$on("kitLoaded",function(e,a){return h&&(b[h].focus=!1),"map"===v?void(v=void 0):(y.center.lat=a.lat,y.center.lng=a.lng,void n(function(){l.getMarkers().then(function(e){var n=_.find(e,function(t){return a.id===t.options.myData.id});l.getLayers().then(function(e){e.overlays.realworld.__proto__.zoomToShowLayer.call(e.overlays.realworld,n,function(){t.$apply(function(){var t=b[a.id];t&&(h=a.id,t.focus=!0)})})})})},2e3))});var w={exposure:null,status:null};y.filterData={indoor:!0,outdoor:!0,online:!0,offline:!0},y.openFilterPopup=m,y.removeFilter=p,u()}angular.module("app.components").controller("MapController",t),t.$inject=["$scope","$state","$timeout","location","markers","device","marker","$mdDialog","leafletData","mapUtils"]}(),function(){"use strict";function t(){return{scope:{show:"="},restrict:"A",controller:"LoginController",controllerAs:"vm",templateUrl:"app/components/login/login.html"}}angular.module("app.components").directive("login",t)}(),function(){"use strict";function t(t,e){function n(){e.show({hasBackdrop:!0,controller:"LoginDialogController",templateUrl:"app/components/login/loginModal.html",clickOutsideToClose:!0}).then(function(){})["finally"](function(){})}t.showLogin=n,t.$on("showLogin",function(){n()})}angular.module("app.components").controller("LoginController",t),t.$inject=["$scope","$mdDialog"]}(),function(){"use strict";function t(t,e,n,a,o,s){function i(){a.logout(),r.isLoggedin=!1}var r=this;r.navRightLayout="space-around center",n.$on("loggedIn",function(t,e){e&&"appLoad"===e.time?n.$apply(function(){r.isLoggedin=!0,r.isShown=!0,angular.element(".nav_right .wrap-dd-menu").css("display","initial"),r.currentUser=a.getCurrentUser().data,r.dropdownOptions[0].text="Hello, "+r.currentUser.username,r.navRightLayout="end center"}):(r.isLoggedin=!0,r.isShown=!0,angular.element(".nav_right .wrap-dd-menu").css("display","initial"),r.currentUser=a.getCurrentUser().data,r.dropdownOptions[0].text="Hello, "+r.currentUser.username,r.navRightLayout="end center")}),n.$on("loggedOut",function(){r.isLoggedIn=!1,r.isShown=!0,angular.element("navbar .wrap-dd-menu").css("display","none"),r.navRightLayout="space-around center"}),r.isShown=!0,r.isLoggedin=!1,r.logout=i,r.dropdownOptions=[{divider:!0,text:"Hello,"},{text:"PROFILE",href:"/profile"},{text:"LOGOUT",href:"/logout"}],r.dropdownSelected=void 0,r.dropdownOptionsCommunity=[{text:"Forum",href:"https://forum.smartcitizen.me/"},{text:"Documentation",href:"http://docs.smartcitizen.me/#/"},{text:"API Reference",href:"http://api.smartcitizen.me/"},{text:"Github",href:"https://github.com/fablabbcn/Smart-Citizen-Kit"}],r.dropdownSelectedCommunity=void 0,n.$on("removeNav",function(){n.$apply(function(){r.isShown=!1})}),n.$on("addNav",function(){n.$apply(function(){r.isShown=!0})}),s(function(){var e=t.search();e.signup?o.showSignup():e.login?angular.element(".navbar_login_button button").click():e.passwordRecovery&&o.showPasswordRecovery()},1e3)}angular.module("app.components").controller("LayoutController",t),t.$inject=["$location","$state","$scope","auth","animation","$timeout"]}(),function(){"use strict";function t(t,e,n,a,o,s,i,r,l,c,u,d,m,p,f,g,v,h,y,k){function b(){v(function(){U(),I(),x()},1e3),w()&&k.info("It looks like this sensor has not posted data since a long time ago ðŸ˜”",!1)}function w(){return _.every(B.sensors,function(t){return"N/A"===t.value})}function S(t){var e=angular.element(".sensors_container"),n=e.scrollLeft(),a=20;"left"===t?e.scrollLeft(n+a):"right"===t&&e.scrollLeft(n-a)}function P(){return B.sensorsToCompare.filter(function(t){return t.id!==B.selectedSensor})}function C(t,e,n){e[0]&&(!G||K)&&(G||(t="date",n||(n={}),n.from=z.getValuePickerFrom(),n.to=z.getValuePickerTo()),"date"===t?(B.loadingChart=!0,T(n.from,n.to).then(function(){B.chartDataMain=L(e)})):"sensor"===t&&(B.chartDataMain=L(e)))}function T(t,e){G=!0;var a=n.id;return i.getSensorsData(a,t,e).then(function(t){K=t.readings})}function L(t){var e=$(K,t[0]),n={data:e,color:B.selectedSensorData.color,unit:B.selectedSensorData.unit};if(t[1]&&-1!==t[1])var a=$(K,t[1]),o={data:a,color:B.selectedSensorToCompareData.color,unit:B.selectedSensorToCompareData.unit};var s=[n,o];return s}function $(t,e){return 0===t.length?[]:t.map(function(t){var n=t&&t.timestamp,a=t&&t.data[e];return a=null===a?0:a,{time:n,data:a}})}function D(t){var e=t.value;void 0!==e&&("main"===t.type?F=e:"compare"===t.type&&(M=e))}function U(){var t=angular.element(".sensor_icon_selected"),e=t.find(".container_parent");e.css("fill",B.selectedSensorData.color)}function A(){var t=angular.element(".sensor_compare").find("md-select-label").find("span");t.css("color",B.selectedSensorToCompareData.color||"white");var e=angular.element(".sensor_compare").find("md-select-label").find(".md-select-icon");e.css("color","white")}function I(){var t;t=angular.element(".chart_move_left").find("svg"),t.find(".fill_container").css("fill","#03252D"),t=angular.element(".chart_move_right").find("svg"),t.find(".fill_container").css("fill","#4E656B")}function x(){var t=angular.element(".kit_time_icon");t.find(".stroke_container").css({"stroke-width":"0.5px",stroke:"#A4B0B3"}),t.find(".fill_container").css("fill","#A4B0B3")}function R(t){return new Date(t).getTime()}function O(){return R(z.getValuePickerTo())-R(z.getValuePickerFrom())}function N(t){var e,n,a=O();if("left"===t)e=z.getValuePickerFrom(),n=R(z.getValuePickerFrom())-a,z.setValuePickers([n,e]);else if("right"===t){var o=u.getToday(),s=z.getValuePickerTo();if(u.isSameDay(o,s))return;n=z.getValuePickerTo(),e=R(z.getValuePickerTo())+a,z.setValuePickers([n,e])}}function E(){function t(){return R(new Date)}function e(){return R(t()-6048e5)}var n="single",a=angular.element("#picker_from").pickadate({onClose:function(){angular.element(document.activeElement).blur()},container:"body",klass:{holder:"picker__holder picker_container"}}),o=a.pickadate("picker"),s=angular.element("#picker_to").pickadate({onClose:function(){angular.element(document.activeElement).blur()},container:"body",klass:{holder:"picker__holder picker_container"}}),i=s.pickadate("picker");return o.get("value")&&i.set("min",o.get("select")),i.get("value")&&o.set("max",i.get("select")),o.on("set",function(t){t.select?(i.get("value")&&"single"===n&&C("date",[F,M],{from:o.get("value"),to:i.get("value")}),i.set("min",o.get("select"))):"clear"in t&&i.set("min",!1)}),i.on("set",function(t){t.select?(o.get("value")&&C("date",[F,M],{from:o.get("value"),to:i.get("value")}),o.set("max",i.get("select"))):"clear"in t&&o.set("max",!1)}),i.set("max",new Date),o.set("select",e()),i.set("select",t()),{getValuePickerFrom:function(){return o.get("value")},setValuePickerFrom:function(t){n="single",o.set("select",t)},getValuePickerTo:function(){return i.get("value")},setValuePickerTo:function(t){n="single",i.set("select",t)},setValuePickers:function(t){var e=t[0],a=t[1];n="pair",o.set("select",e),i.set("select",a)}}}var F,M,K,B=this,G=!1,z=E();console.log("controller loaded"),d.kitLoaded({lat:a.latitude,lng:a.longitude,id:parseInt(n.id)}),B.kit=a,B.ownerKits=o,B.kitBelongsToUser=c,B.battery=h[1],B.sensors=h[0],B.sensorsToCompare=y,B.slide=S,B.chartData=[],B.selectedSensor=B.sensors[0].id,B.selectedSensorData={},B.selectedSensorToCompare=void 0,B.selectedSensorToCompareData={},B.moveChart=N,B.loadingChart=!0,B.dropdownOptions=[{text:"SET UP",value:"1"},{text:"EDIT",value:"2"}],B.dropdownSelected=void 0,e.$watch("vm.selectedSensor",function(t){B.selectedSensorToCompare=void 0,B.selectedSensorToCompareData={},B.chartDataCompare=[],M=void 0,B.sensors.forEach(function(e){e.id===t&&_.extend(B.selectedSensorData,e)}),B.sensorsToCompare=P(),v(function(){U(),A(),D({type:"main",value:t}),C("sensor",[F,M])},100)}),e.$watch("vm.selectedSensorToCompare",function(t,e){B.sensorsToCompare.forEach(function(e){e.id===t&&_.extend(B.selectedSensorToCompareData,e)}),v(function(){A(),D({type:"compare",value:t}),(void 0!==e||void 0!==t)&&C("sensor",[F,M])},100)}),e.$on("hideChartSpinner",function(){B.loadingChart=!1}),e.$on("loggedIn",function(){var t=parseInt(n.id),e=p.getCurrentUser().data,a=f.belongsToUser(e.kits,t),o=g.isAdmin(e);(o||a)&&(B.kitBelongsToUser=!0)}),e.$on("loggedOut",function(){B.kitBelongsToUser=!1}),b()}angular.module("app.components").controller("KitController",t),t.$inject=["$state","$scope","$stateParams","kitData","ownerKits","utils","sensor","FullKit","$mdDialog","belongsToUser","timeUtils","animation","$location","auth","kitUtils","userUtils","$timeout","mainSensors","compareSensors","alert"]}(),function(){"use strict";function t(){}angular.module("app.components").controller("HomeController",t)}(),function(){"use strict";function t(){return function(t,e){return void 0===e?t:t?_.filter(t,function(t){var n=-1!==t.labels.indexOf(e);if(n)return n;var a="online"===e&&_.some(t.labels,function(t){return-1!==t.indexOf("new")});return a}):void 0}}angular.module("app.components").filter("filterLabel",t)}(),function(){"use strict";function t(t,e,n,a,o){t.answer=function(o){t.waitingFromServer=!0,n.createUser(o).then(function(){a.success("Signup was successful"),e.hide()})["catch"](function(e){a.error("Signup failed"),t.errors=e.data.errors})["finally"](function(){t.waitingFromServer=!1})},t.hide=function(){e.hide()},t.cancel=function(){e.cancel()},t.openLogin=function(){o.showLogin(),e.hide()}}angular.module("app.components").controller("SignupDialogController",t),t.$inject=["$scope","$mdDialog","user","alert","animation"]}(),function(){"use strict";function t(t,e,n,a,o,s){t.password={newPassword:void 0,confirmPassword:void 0},t.isDifferent=!1,t.answer=function(i){return i.newPassword!==i.confirmPassword?void(t.isDifferent=!0):(t.isDifferent=!1,void o.patchResetPassword(n.code,{password:i.newPassword}).then(function(){s.success("Your data was updated successfully"),a.path("/profile"),e.hide()})["catch"](function(){s.error("Your data wasn't updated")}))},t.cancel=function(){e.hide()},t.hide=function(){e.hide()}}angular.module("app.components").controller("PasswordResetDialogController",t),t.$inject=["$scope","$mdDialog","$stateParams","$location","auth","alert"]}(),function(){"use strict";function t(t,e,n,a,o){t.hide=function(){n.hide()},t.cancel=function(){n.cancel()},t.recoverPassword=function(){t.waitingFromServer=!0;var e={email_or_username:t.input};a.recoverPassword(e).then(function(){o.success("You were sent an email to recover your password"),n.hide()})["catch"](function(e){o.error("That username doesn't exist"),t.errors=e.data})["finally"](function(){t.waitingFromServer=!1})},t.openSignup=function(){e.showSignup(),n.hide()}}angular.module("app.components").controller("PasswordRecoveryDialogController",t),t.$inject=["$scope","animation","$mdDialog","auth","alert"]}(),function(){"use strict";function t(t,e,n,a){var o={exposure:null,status:null};t.form={indoor:!1,outdoor:!1,online:!1,offline:!1},_.extend(t.form,n),t.answer=function(n){n||(n=_.each(t.form,function(t,e,n){n[e]=!0})),e.hide(n,o)},t.hide=function(){e.hide()},t.cancel=function(){e.hide()},t.applyFilterRules=function(){_.extend(t.form,a.getDefaultFilters(t.form,o)),_.extend(o,a.setDefaultFilters(t.form,o))}}angular.module("app.components").controller("MapFilterDialogController",t),t.$inject=["$scope","$mdDialog","filterData","mapUtils"]}(),function(){"use strict";function t(t,e,n,a,o){t.answer=function(o){t.waitingFromServer=!0,n.login(o).then(function(t){var o=t.access_token;n.saveData(o),a.success("Signup was successful"),e.hide()})["catch"](function(){a.error("Username or password incorrect")})["finally"](function(){t.waitingFromServer=!1})},t.hide=function(){e.hide()},t.cancel=function(){e.hide()},t.openSignup=function(){o.showSignup(),e.hide()},t.openPasswordRecovery=function(){e.show({hasBackdrop:!0,controller:"PasswordRecoveryDialogController",templateUrl:"app/components/passwordRecovery/passwordRecoveryModal.html",clickOutsideToClose:!0}).then(function(){})["finally"](function(){}),e.hide()
}}angular.module("app.components").controller("LoginDialogController",t),t.$inject=["$scope","$mdDialog","auth","alert","animation"]}(),function(){"use strict";angular.module("app.components").constant("MARKER_ICONS",{defaultIcon:{},smartCitizenNormal:{type:"div",className:"marker_normal",iconSize:[24,24]},smartCitizenOnline:{type:"div",className:"marker_online",iconSize:[24,24]},smartCitizenOffline:{type:"div",className:"marker_offline",iconSize:[24,24]}})}(),function(){"use strict";angular.module("app.components").constant("COUNTRY_CODES",{AF:"Afghanistan",AX:"Aland Islands",AL:"Albania",DZ:"Algeria",AS:"American Samoa",AD:"Andorra",AO:"Angola",AI:"Anguilla",AQ:"Antarctica",AG:"Antigua And Barbuda",AR:"Argentina",AM:"Armenia",AW:"Aruba",AU:"Australia",AT:"Austria",AZ:"Azerbaijan",BS:"Bahamas",BH:"Bahrain",BD:"Bangladesh",BB:"Barbados",BY:"Belarus",BE:"Belgium",BZ:"Belize",BJ:"Benin",BM:"Bermuda",BT:"Bhutan",BO:"Bolivia",BA:"Bosnia And Herzegovina",BW:"Botswana",BV:"Bouvet Island",BR:"Brazil",IO:"British Indian Ocean Territory",BN:"Brunei Darussalam",BG:"Bulgaria",BF:"Burkina Faso",BI:"Burundi",KH:"Cambodia",CM:"Cameroon",CA:"Canada",CV:"Cape Verde",KY:"Cayman Islands",CF:"Central African Republic",TD:"Chad",CL:"Chile",CN:"China",CX:"Christmas Island",CC:"Cocos (Keeling) Islands",CO:"Colombia",KM:"Comoros",CG:"Congo",CD:"Congo, Democratic Republic",CK:"Cook Islands",CR:"Costa Rica",CI:"Cote D'Ivoire",HR:"Croatia",CU:"Cuba",CY:"Cyprus",CZ:"Czech Republic",DK:"Denmark",DJ:"Djibouti",DM:"Dominica",DO:"Dominican Republic",EC:"Ecuador",EG:"Egypt",SV:"El Salvador",GQ:"Equatorial Guinea",ER:"Eritrea",EE:"Estonia",ET:"Ethiopia",FK:"Falkland Islands (Malvinas)",FO:"Faroe Islands",FJ:"Fiji",FI:"Finland",FR:"France",GF:"French Guiana",PF:"French Polynesia",TF:"French Southern Territories",GA:"Gabon",GM:"Gambia",GE:"Georgia",DE:"Germany",GH:"Ghana",GI:"Gibraltar",GR:"Greece",GL:"Greenland",GD:"Grenada",GP:"Guadeloupe",GU:"Guam",GT:"Guatemala",GG:"Guernsey",GN:"Guinea",GW:"Guinea-Bissau",GY:"Guyana",HT:"Haiti",HM:"Heard Island & Mcdonald Islands",VA:"Holy See (Vatican City State)",HN:"Honduras",HK:"Hong Kong",HU:"Hungary",IS:"Iceland",IN:"India",ID:"Indonesia",IR:"Iran, Islamic Republic Of",IQ:"Iraq",IE:"Ireland",IM:"Isle Of Man",IL:"Israel",IT:"Italy",JM:"Jamaica",JP:"Japan",JE:"Jersey",JO:"Jordan",KZ:"Kazakhstan",KE:"Kenya",KI:"Kiribati",KR:"Korea",KW:"Kuwait",KG:"Kyrgyzstan",LA:"Lao People's Democratic Republic",LV:"Latvia",LB:"Lebanon",LS:"Lesotho",LR:"Liberia",LY:"Libyan Arab Jamahiriya",LI:"Liechtenstein",LT:"Lithuania",LU:"Luxembourg",MO:"Macao",MK:"Macedonia",MG:"Madagascar",MW:"Malawi",MY:"Malaysia",MV:"Maldives",ML:"Mali",MT:"Malta",MH:"Marshall Islands",MQ:"Martinique",MR:"Mauritania",MU:"Mauritius",YT:"Mayotte",MX:"Mexico",FM:"Micronesia, Federated States Of",MD:"Moldova",MC:"Monaco",MN:"Mongolia",ME:"Montenegro",MS:"Montserrat",MA:"Morocco",MZ:"Mozambique",MM:"Myanmar",NA:"Namibia",NR:"Nauru",NP:"Nepal",NL:"Netherlands",AN:"Netherlands Antilles",NC:"New Caledonia",NZ:"New Zealand",NI:"Nicaragua",NE:"Niger",NG:"Nigeria",NU:"Niue",NF:"Norfolk Island",MP:"Northern Mariana Islands",NO:"Norway",OM:"Oman",PK:"Pakistan",PW:"Palau",PS:"Palestinian Territory, Occupied",PA:"Panama",PG:"Papua New Guinea",PY:"Paraguay",PE:"Peru",PH:"Philippines",PN:"Pitcairn",PL:"Poland",PT:"Portugal",PR:"Puerto Rico",QA:"Qatar",RE:"Reunion",RO:"Romania",RU:"Russian Federation",RW:"Rwanda",BL:"Saint Barthelemy",SH:"Saint Helena",KN:"Saint Kitts And Nevis",LC:"Saint Lucia",MF:"Saint Martin",PM:"Saint Pierre And Miquelon",VC:"Saint Vincent And Grenadines",WS:"Samoa",SM:"San Marino",ST:"Sao Tome And Principe",SA:"Saudi Arabia",SN:"Senegal",RS:"Serbia",SC:"Seychelles",SL:"Sierra Leone",SG:"Singapore",SK:"Slovakia",SI:"Slovenia",SB:"Solomon Islands",SO:"Somalia",ZA:"South Africa",GS:"South Georgia And Sandwich Isl.",ES:"Spain",LK:"Sri Lanka",SD:"Sudan",SR:"Suriname",SJ:"Svalbard And Jan Mayen",SZ:"Swaziland",SE:"Sweden",CH:"Switzerland",SY:"Syrian Arab Republic",TW:"Taiwan",TJ:"Tajikistan",TZ:"Tanzania",TH:"Thailand",TL:"Timor-Leste",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinidad And Tobago",TN:"Tunisia",TR:"Turkey",TM:"Turkmenistan",TC:"Turks And Caicos Islands",TV:"Tuvalu",UG:"Uganda",UA:"Ukraine",AE:"United Arab Emirates",GB:"United Kingdom",US:"United States",UM:"United States Outlying Islands",UY:"Uruguay",UZ:"Uzbekistan",VU:"Vanuatu",VE:"Venezuela",VN:"Viet Nam",VG:"Virgin Islands, British",VI:"Virgin Islands, U.S.",WF:"Wallis And Futuna",EH:"Western Sahara",YE:"Yemen",ZM:"Zambia",ZW:"Zimbabwe"})}(),function(){"use strict";function t(t,e,n,a){function o(t,o){n(function(){s(o[0])},0);var r={};angular.element(a).on("resize",function(){s(o[0]),i(r.data,{type:r.type,container:o[0],color:r.color,unit:r.unit})}),t.$watch("chartData",function(t){if(t&&void 0!==t){if(t[0]&&t[1]){var n=t[0].data,a=n.map(function(t){return{date:P(t.time),count:t&&t.data}});a.sort(function(t,e){return t.date-e.date});var s=t[1].data,l=s.map(function(t){return{date:P(t.time),count:t&&t.data}});l.sort(function(t,e){return t.date-e.date});var c=[a,l],u=[t[0].color,t[1].color],d=[t[0].unit,t[1].unit];r={data:c,type:"both",color:u,unit:d},i(c,{type:"both",container:o[0],color:u,unit:d})}else if(t[0]){var m=t[0].data,c=m.map(function(t){return{date:P(t.time),count:t&&t.data}});c.sort(function(t,e){return t.date-e.date});var p=t[0].color,f=t[0].unit;r={data:c,type:"main",color:p,unit:f},i(c,{type:"main",container:o[0],color:p,unit:f})}e.hideChartSpinner()}})}function s(t){d3.select(t).selectAll("*").remove(),f={top:20,right:15,bottom:20,left:40},g=t.clientWidth-f.left-f.right,v=t.clientHeight-f.top-f.bottom,_=d3.time.scale.utc().range([0,g]),y=d3.scale.linear().range([v,0]),k=d3.scale.linear().range([v,0]),I=d3.scale.linear().range([v,0]),P=d3.time.format.utc("%Y-%m-%dT%H:%M:%SZ").parse,b=d3.svg.axis().scale(_).orient("bottom").ticks(5),w=d3.svg.axis().scale(y).orient("left").ticks(5),S=d3.svg.axis().scale(k).orient("right").ticks(5),C=d3.svg.area().interpolate("linear").x(function(t){return _(t.date)}).y0(v).y1(function(t){return y(t.count)}),T=d3.svg.line().interpolate("linear").x(function(t){return _(t.date)}).y(function(t){return y(t.count)}),L=d3.svg.area().interpolate("linear").x(function(t){return _(t.date)}).y0(v).y1(function(t){return k(t.count)}),$=d3.svg.line().interpolate("linear").x(function(t){return _(t.date)}).y(function(t){return k(t.count)}),h=d3.select(t).append("svg").attr("width",g+f.left+f.right).attr("height",v+f.top+f.bottom).append("g").attr("transform","translate("+(f.left-f.right)+","+f.top+")")}function i(t,e){"main"===e.type?r(t,e):"both"===e.type&&l(t,e)}function r(t,e){function n(){var n=d3.bisector(function(t){return t.date}).left,a=_.invert(d3.mouse(this)[0]),o=n(t,a,1),s=t[o-1],i=t[o],r=a-s.date>i.date-a?i:s;U.attr("transform","translate("+_(r.date)+", "+y(r.count)+")");var l=A.select("text"),c=l.select(".popup_main"),u=(c.select(".popup_value").text(d(r.count)),c.select(".popup_unit").text(e.unit),l.select(".popup_date").text(m(r.date))),f=[c,u],g=p(x,f);_(r.date)+80+g>e.container.clientWidth?A.attr("transform","translate("+(_(r.date)-120)+", "+(d3.mouse(this)[1]-20)+")"):A.attr("transform","translate("+(_(r.date)+80)+", "+(d3.mouse(this)[1]-20)+")")}_.domain(d3.extent(t,function(t){return t.date})),y.domain([.8*d3.min(t,function(t){return t.count}),1.2*d3.max(t,function(t){return t.count})]),h.selectAll("*").remove(),h.append("path").datum(t).attr("class","chart_area").attr("fill",e.color).attr("d",C),h.append("path").attr("class","chart_line").attr("stroke",e.color).attr("d",T(t)),h.append("g").attr("class","axis x").attr("transform","translate(0,"+v+")").call(b),h.append("g").attr("class","axis y_left").style("fill",e.color).call(w),h.append("g").attr("class","grid").attr("transform","translate(0,"+v+")").call(c().tickSize(-v,0,0).tickFormat("")),h.append("g").attr("class","grid").call(u().tickSize(-g,0,0).tickFormat("")),U=h.append("g").attr("class","focus").style("display","none"),U.append("circle").style("stroke",e.color).attr("r",4.5);var a=84,o=46;A=h.append("g").attr("class","focus").style("display","none"),x=A.append("rect").attr("width",a).attr("height",o).attr("transform",function(){var t="translate(-42, 5)";return t}).style("stroke","grey").style("stroke-width","0.5").style("fill","white");var s=A.append("text").attr("class",""),i=s.append("tspan").attr("class","popup_main").attr("text-anchor","start").attr("x",-a/2).attr("dx",8).attr("y",o/2).attr("dy",3);i.append("tspan").attr("class","popup_value"),i.append("tspan").attr("class","popup_unit").attr("dx",5),s.append("tspan").attr("class","popup_date").attr("x",-a/2).attr("dx",8).attr("y",o-2).attr("dy",0).attr("text-anchor","start"),h.append("rect").attr("class","overlay").attr("width",g).attr("height",v).on("mouseover",function(){A.style("display",null),U.style("display",null)}).on("mouseout",function(){A.style("display","none"),U.style("display","none")}).on("mousemove",n)}function l(t,e){function n(){var n=d3.bisector(function(t){return t.date}).left,a=_.invert(d3.mouse(this)[0]),o=n(t[1],a,1),s=t[1][o-1],i=t[1][o],r=a-s.date>i.date-a?i:s;D.attr("transform","translate("+_(r.date)+", "+k(r.count)+")");var l=t[0][o-1],c=t[0][o],u=a-l.date>c.date-a?c:l;U.attr("transform","translate("+_(u.date)+", "+y(u.count)+")");var f=A.select("text"),g=f.select(".popup_main");g.select(".popup_value").text(d(u.count)),g.select(".popup_unit").text(e.unit[0]);var v=f.select(".popup_compare");v.select(".popup_value").text(d(r.count)),v.select(".popup_unit").text(e.unit[1]);var h=f.select(".popup_date").text(m(r.date)),b=[g,v,h],w=p(x,b);_(r.date)+80+w>e.container.clientWidth?A.attr("transform","translate("+(_(r.date)-120)+", "+(d3.mouse(this)[1]-20)+")"):A.attr("transform","translate("+(_(r.date)+80)+", "+(d3.mouse(this)[1]-20)+")")}_.domain(d3.extent(t[0],function(t){return t.date})),y.domain([.8*d3.min(t[0],function(t){return t.count}),1.2*d3.max(t[0],function(t){return t.count})]),k.domain([.8*d3.min(t[1],function(t){return t.count}),1.2*d3.max(t[1],function(t){return t.count})]),h.selectAll("*").remove(),h.append("path").datum(t[0]).attr("class","chart_area").attr("fill",e.color[0]).attr("d",C),h.append("path").datum(t[1]).attr("class","chart_area").attr("fill",e.color[1]).attr("d",L),h.append("path").attr("class","chart_line").attr("stroke",e.color[0]).attr("d",T(t[0])),h.append("path").attr("class","chart_line").attr("stroke",e.color[1]).attr("d",$(t[1])),h.append("g").attr("class","axis x").attr("transform","translate(0,"+v+")").call(b),h.append("g").attr("class","axis y_left").style("fill",e.color[0]).call(w),h.append("g").attr("class","axis y_right").style("fill",e.color[1]).attr("transform","translate("+g+" ,0)").call(S),h.append("g").attr("class","grid").attr("transform","translate(0,"+v+")").call(c().tickSize(-v,0,0).tickFormat("")),h.append("g").attr("class","grid").call(u().tickSize(-g,0,0).tickFormat("")),D=h.append("g").attr("class","focus").style("display","none"),U=h.append("g").attr("class","focus").style("display","none"),D.append("circle").style("stroke",e.color[1]).attr("r",4.5),U.append("circle").style("stroke",e.color[0]).attr("r",4.5);var a=84,o=75;A=h.append("g").attr("class","focus").style("display","none"),x=A.append("rect").attr("width",a).attr("height",o).style("min-width","40px").attr("transform",function(){var t="translate(-42, 5)";return t}).style("stroke","grey").style("stroke-width","0.5").style("fill","white"),A.append("rect").attr("width",8).attr("height",2).attr("transform",function(){return"translate("+(-a/2+4).toString()+", 20)"}).style("fill",e.color[0]),A.append("rect").attr("width",8).attr("height",2).attr("transform",function(){return"translate("+(-a/2+4).toString()+", 45)"}).style("fill",e.color[1]);var s=A.append("text").attr("class",""),i=s.append("tspan").attr("class","popup_main").attr("x",-o/2+7).attr("dx",8).attr("y",o/3).attr("dy",3);i.append("tspan").attr("class","popup_value").attr("text-anchor","start"),i.append("tspan").attr("class","popup_unit").attr("dx",5);var r=s.append("tspan").attr("class","popup_compare").attr("x",-o/2+7).attr("dx",8).attr("y",o/1.5).attr("dy",3);r.append("tspan").attr("class","popup_value").attr("text-anchor","start"),r.append("tspan").attr("class","popup_unit").attr("dx",5),s.append("tspan").attr("class","popup_date").attr("x",-a/2).attr("dx",8).attr("y",o-2).attr("dy",0).attr("text-anchor","start"),h.append("rect").attr("class","overlay").attr("width",g).attr("height",v).on("mouseover",function(){D.style("display",null),U.style("display",null),A.style("display",null)}).on("mouseout",function(){D.style("display","none"),U.style("display","none"),A.style("display","none")}).on("mousemove",n)}function c(){return d3.svg.axis().scale(_).orient("bottom").ticks(5)}function u(){return d3.svg.axis().scale(y).orient("left").ticks(5)}function d(t){if(-1!==t.toString().indexOf(".")){var e=t.toString().split(".");return e[0]+"."+e[1].slice(0,2)}return t.toString().slice(0,2)}function m(t){return moment(t).format("h:mm a ddd Do MMM YYYY")}function p(t,e){function n(t){return t.node().getBBox()}if(e.length){var a=e.reduce(function(t,e){var a=n(e),o=n(t);return o.width>=a.width?t:e},e[0]),o=2*a.attr("dx");return t.attr("width",n(a).width+o),n(a).width+o}}var f,g,v,h,_,y,k,b,w,S,P,C,T,L,$,D,U,A,I,x;return{link:o,restrict:"A",scope:{chartData:"="}}}angular.module("app.components").directive("chart",t),t.$inject=["sensor","animation","$timeout","$window"]}(),function(){"use strict";function t(t,e){function n(t){return e.all("users").post(t)}function a(t){return e.one("users",t).get()}function o(t){return e.all("me").customPUT(t)}function s(){return e.all("me").remove()}var i={createUser:n,getUser:a,updateUser:o,removeUser:s};return i}angular.module("app.components").factory("user",t),t.$inject=["$http","Restangular"]}(),function(){"use strict";function t(t,e,n){function a(){return t.all("sensors").getList()}function o(t){t=t}function s(){return r}function i(a,o,s){var i=n.getRollup(o,s);return o=e.convertTime(o),s=e.convertTime(s),o&&s?t.one("devices",a).customGET("pg_readings",{from:o,to:s,all_intervals:!0,rollup:i}):t.one("devices",a).customGET("pg_readings")}var r;a().then(function(t){console.log("sensors",t.plain()),o(t)});var l={callAPI:a,setTypes:o,getTypes:s,getSensorsData:i};return l}angular.module("app.components").factory("sensor",t),t.$inject=["Restangular","utils","sensorUtils"]}(),function(){"use strict";function t(t,e){function n(t){return e.all("search").getList({q:t})}var a={globalSearch:n};return a}angular.module("app.components").factory("search",t),t.$inject=["$http","Restangular"]}(),function(){"use strict";function t(t){function e(t){o=t}function n(){return o}function a(){t.$broadcast("markerLoaded")}var o,s={setCurrentMarker:e,getCurrentMarker:n,dataLoaded:a};return s}angular.module("app.components").factory("marker",t),t.$inject=["$rootScope"]}(),function(){"use strict";function t(t){function e(){return a().success(function(t){var e=t.loc.split(",");return o={lat:parseFloat(e[0]),lng:parseFloat(e[1])}})}function n(){return o}function a(){return t.jsonp("http://ipinfo.io/?callback=JSON_CALLBACK")}var o;e();var s={getPosition:e,callAPI:a,getPositionObj:n};return s}angular.module("app.components").factory("geolocation",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e){function n(e){var n={filename:e};return t.all("uploads").post(n)}function a(t,n,a,o){return e.upload({url:"https://smartcitizen.s3-eu-west-1.amazonaws.com",method:"POST",fields:{key:n,policy:a,signature:o,AWSAccessKeyId:"AKIAJ753OQI6JPSDCPHA",acl:"public-read",success_action_status:200},file:t})}function o(t,e){return e=void 0===e?"s101":e,"https://images.smartcitizen.me/"+e+"/"+t}var s={getCredentials:n,uploadFile:a,getImageURL:o};return s}angular.module("app.components").factory("file",t),t.$inject=["Restangular","Upload"]}(),function(){"use strict";function t(t,e){function n(e){var n="";return n+=e.lat+","+e.lng,t.all("devices").getList({near:n})}function a(){return t.all("devices/world_map").getList().then(function(t){return t})}function o(e){return t.one("devices",e).get()}function s(){return t.all("kits").getList()}function i(){return c}function r(){return u||e.localStorage.getItem("smartcitizen.markers")&&JSON.parse(e.localStorage.getItem("smartcitizen.markers"))}function l(t){e.localStorage.setItem("smartcitizen.markers",JSON.stringify(t)),u=t}var c,u;s().then(function(t){c=_.indexBy(t,"id")});var d={getDevices:n,getAllDevices:a,getDevice:o,getGenericKitData:i,getWorldMarkers:r,setWorldMarkers:l};return d}angular.module("app.components").factory("device",t),t.$inject=["Restangular","$window"]}(),function(){"use strict";function t(t,e,n,a,o,s,i){function r(){l("appLoad")}function l(n){P.token=JSON.parse(e.localStorage.getItem("smartcitizen.token")),P.data=e.localStorage.getItem("smartcitizen.data")&&new s(JSON.parse(e.localStorage.getItem("smartcitizen.data"))),P.token&&f().then(function(a){e.localStorage.setItem("smartcitizen.data",JSON.stringify(a.plain()));var r=new s(a);P.data&&P.data.role!==r.role&&(P.data=r,t.path("/")),P.data=r,n&&"appLoad"===n?i(function(){o.$broadcast("loggedIn",{time:"appLoad"})},2e3):o.$broadcast("loggedIn",{})})}function c(){return P}function u(){return!!e.localStorage.getItem("smartcitizen.token")}function d(t){e.localStorage.setItem("smartcitizen.token",JSON.stringify(t)),l()}function m(t){return a.all("sessions").post(t)}function p(){e.localStorage.removeItem("smartcitizen.token"),e.localStorage.removeItem("smartcitizen.data")}function f(){return a.all("").customGET("me")}function g(t){return a.all("password_resets").post(t)}function v(t){return a.one("password_resets",t).get()}function h(t,e){return a.one("password_resets",t).patch(e)}function _(t){w||(w=t)}function y(t){S=t}function k(){return S}function b(t){return"admin"===t.role}var w,S,P={token:null,data:null};i(function(){r()},0);var C={isAuth:u,setCurrentUser:l,getCurrentUser:c,saveData:d,login:m,logout:p,recoverPassword:g,getResetPassword:v,patchResetPassword:h,registerCallback:_,setReloading:y,reloading:k,isAdmin:b};return C}angular.module("app.components").factory("auth",t),t.$inject=["$location","$window","$state","Restangular","$rootScope","AuthUser","$timeout"]}(),function(){"use strict";function t(){function t(t,e){t.element=e}function e(t){t.slidePosition=0,t.slideSize=20,this.getTimesSlided=function(){return t.slideSize},this.getPosition=function(){return t.slidePosition*t.slideSize},this.decrementPosition=function(){t.slidePosition-=1},this.incrementPosition=function(){t.slidePosition+=1},this.scrollIsValid=function(e){var n=t.element.scrollLeft();return console.log("scrollpos",n),"left"===e?n>0&&t.slidePosition>=0:"right"===e?300>n:void 0}}return e.$inject=["$scope"],{controller:e,link:t}}function e(){function t(t,e,n,a){var o=angular.element(".sensors_container");e.on("click",function(){a.scrollIsValid("left")&&"left"===n.direction?(a.decrementPosition(),o.scrollLeft(a.getPosition()),console.log(a.getPosition())):a.scrollIsValid("right")&&"right"===n.direction&&(a.incrementPosition(),o.scrollLeft(a.getPosition()),console.log(a.getPosition()))})}return{link:t,require:"^slide-menu",restrict:"A",scope:{direction:"@"}}}angular.module("app.components").directive("slide",e).directive("slideMenu",t),e.$inject=[]}(),function(){"use strict";function t(){function t(t){n=t}function e(){return n}var n,a={setKit:t,getKit:e};return a}angular.module("app.components").factory("layout",t)}(),function(){"use strict";function t(t,e){function n(n,a){a.on("scroll",function(){var t=angular.element(this).scrollLeft(),e=this.scrollWidth,n=angular.element(this).width();return e-n>2&&(angular.element(".button_scroll_left").css("opacity","1"),angular.element(".button_scroll_right").css("opacity","1")),2>=e-n-t&&angular.element(".button_scroll_right").css("opacity","0.5"),0===t?void angular.element(".button_scroll_left").css("opacity","0.5"):(angular.element(".button_scroll_left").css("opacity","1"),void angular.element(".button_scroll_right").css("opacity","1"))}),e(function(){a.trigger("scroll")}),angular.element(t).on("resize",function(){e(function(){a.trigger("scroll")},1e3)})}return{link:n,restrict:"A"}}angular.module("app.components").directive("horizontalScroll",t),t.$inject=["$window","$timeout"]}(),function(){"use strict";function t(t){function e(){t.$broadcast("blur")}function n(){t.$broadcast("unblur")}function a(){t.$broadcast("removeNav")}function o(){t.$broadcast("addNav")}function s(){t.$broadcast("showChartSpinner")}function i(){t.$broadcast("hideChartSpinner")}function r(e){t.$broadcast("kitLoaded",e)}function l(){t.$broadcast("showPasswordRecovery")}function c(){t.$broadcast("showLogin")}function u(){t.$broadcast("showSignup")}function d(){t.$broadcast("showPasswordReset")}function m(){t.$broadcast("hideAlert")}var p={blur:e,unblur:n,removeNav:a,addNav:o,showChartSpinner:s,hideChartSpinner:i,kitLoaded:r,showPasswordRecovery:l,showLogin:c,showSignup:u,showPasswordReset:d,hideAlert:m};return p}angular.module("app.components").factory("animation",t),t.$inject=["$rootScope"]}(),function(){"use strict";function t(){function t(t,e){t.$watch("moveDown",function(t){t?e.addClass("move_down"):e.removeClass("move_down")})}return{link:t,scope:!1,restrict:"A"}}function e(t,e){function n(n,a){var o=a[0].offsetTop,s=angular.element(".stickNav").height();e(function(){o=a[0].offsetTop,s=angular.element(".stickNav").height()},1e3),angular.element(t).on("scroll",function(){var t=document.body.scrollTop;t+s>=o?(a.addClass("stickMenu"),n.$apply(function(){n.moveDown=!0})):(a.removeClass("stickMenu"),n.$apply(function(){n.moveDown=!1}))})}return{link:n,scope:!1,restrict:"A"}}function n(){function t(t,e){t.$on("blur",function(){e.addClass("blur")}),t.$on("unblur",function(){e.removeClass("blur")})}return{link:t,scope:!1,restrict:"A"}}function a(t){function e(e,n){n.on("focusin",function(){t.removeNav()}),n.on("focusout",function(){t.addNav()});var a=n.find("input");a.on("blur",function(){angular.element(document.body).css("overflow","auto")}),a.on("focus",function(){angular.element(document.body).css("overflow","hidden")})}return{link:e}}function o(t,e,n){function a(e,a){var o=t[0].body.clientHeight,s=angular.element(".stickNav").height();n(function(){var t=angular.element(".kit_overview").height(),e=angular.element(".kit_menu").height(),n=(angular.element(".kit_chart").height(),o-s-e-t);a.css("height",n+"px")})}return{link:a,scope:!0,restrict:"A"}}function s(t,e,n){function a(t,e){var a=n[0].body.clientHeight,o=angular.element(".kit_overview").height(),s=angular.element(".kit_menu").height(),i=(angular.element(".kit_chart").height(),a-s-o);e.css("margin-top",i+"px")}return{link:a}}function i(t){function e(e,n){t(function(){n.focus()})}return{link:e}}angular.module("app.components").directive("moveDown",t).directive("stick",e).directive("blur",n).directive("focus",a).directive("changeMapHeight",o).directive("changeContentMargin",s).directive("focusInput",i),t.$inject=[],e.$inject=["$window","$timeout"],a.$inject=["animation"],o.$inject=["$document","layout","$timeout"],s.$inject=["layout","$timeout","$document"],i.$inject=["$timeout"]}(),function(){"use strict";function t(t,e){function n(n,a){function o(t){l&&angular.element(e).scrollTop(t-l.navbar.height-l.kitMenu.height)}function s(t){return c[t]}function i(){var t=angular.element(".md-button.button_active");if(t.length){t.removeClass("button_active");var e=t.find(".stroke_container");e.css("stroke","none"),e.css("stroke-width","1");var n=e.find(".fill_container");n.css("fill","#82A7B0")}}function r(t){var e=angular.element(t);e.addClass("button_active");var n=e.find(".stroke_container");n.css("stroke","white"),n.css("stroke-width","0.01px");var a=n.find(".fill_container");a.css("fill","white")}var l,c=a.children();t(function(){l={navbar:{height:angular.element(".stickNav").height()},kitMenu:{height:angular.element(".kit_menu").height()},kitOverview:{height:angular.element(".kit_overview").height(),offset:angular.element(".kit_overview").offset().top,buttonOrder:0},kitDashboard:{height:angular.element(".kit_chart").height(),offset:angular.element(".kit_chart").offset().top,buttonOrder:1},kitUser:{},kitComments:{}}},1e3),_.each(c,function(t){angular.element(t).on("click",function(){var t=angular.element(this).index();for(var e in l)if(l[e].buttonOrder===t){var n=l[e].offset;o(n)}})});var u;angular.element(e).on("scroll",function(){var t,e=document.body.scrollTop,n=e+l.navbar.height+l.kitMenu.height;"none"!==u&&n<=l.kitOverview.offset?(t=s(l.kitOverview.buttonOrder),i(),u="none"):"overview"!==u&&n>=l.kitOverview.offset&&n<=l.kitOverview.offset+l.kitOverview.height?(t=s(l.kitOverview.buttonOrder),i(),r(t),u="overview"):"chart"!==u&&n>=l.kitDashboard.offset&&n<=l.kitDashboard.offset+l.kitDashboard.height&&(t=s(l.kitDashboard.buttonOrder),i(),r(t),u="chart")})}return{link:n,restrict:"A"}}angular.module("app.components").directive("activeButton",t),t.$inject=["$timeout","$window"]}(),function(){"use strict";function t(t){function e(t){o("success",t)}function n(t){o("error",t)}function a(t,e){o("info",t,void 0,e)}function o(e,n,a,o){a=void 0===a?"top":a,o=void 0===o?5e3:o,t.show({controller:"AlertController",controllerAs:"vm",templateUrl:"app/components/alert/alert"+e+".html",hideDelay:o,position:a,locals:{message:n}})}var s={success:e,error:n,info:a};return s}angular.module("app.components").factory("alert",t),t.$inject=["$mdToast"]}(),function(){"use strict";function t(t,e,n){function a(){e.hide()}var o=this;o.close=a,o.message=n,t.$on("hideAlert",function(){a()})}angular.module("app.components").controller("AlertController",t),t.$inject=["$scope","$mdToast","message"]}(),function(){"use strict";angular.module("app.auth",[])}(),function(){"use strict"}(),angular.module("app",["ngFileUpload","ngMaterial","ui.router","restangular","angularSpinner","ngDropdowns","oauth","leaflet-directive","app.components","app.auth"]),function(){"use strict";function t(t,e,n,a){t.state("landing",{url:"/",resolve:{location:["geolocation",function(t){var e=t.getPositionObj();return e?e:t.callAPI().then(function(t){var e=t.data.loc.split(","),n={lat:parseFloat(e[0]),lng:parseFloat(e[1])};return n})["catch"](function(t){throw new Error(t)})}],initialMarkers:["$state","device","location","HasSensorKit",function(t,e,n,a){return console.log("lo",n),n&&n.lat&&n.lng||(n={lat:41.386,lng:2.1482}),e.getDevices(n).then(function(e){e=e.plain(),_(e).chain().map(function(t){return new a(t)}).filter(function(t){return!!t.longitude&&!!t.latitude}).find(function(t){return t.sensorsHasData()}).tap(function(n){n?t.go("layout.home.kit",{id:n.id}):t.go("layout.home.kit",{id:e[0].id})}).value()})}]}}).state("layout",{url:"","abstract":!0,templateUrl:"app/components/layout/layout.html",controller:"LayoutController",controllerAs:"vm"}).state("layout.home",{url:"/kits","abstract":!0,views:{"":{templateUrl:"app/components/home/template.html"},"map@layout.home":{templateUrl:"app/components/map/map.html",controller:"MapController",controllerAs:"vm"}},resolve:{location:["geolocation",function(t){return t.callAPI().then(function(t){var e=t.data.loc.split(","),n={lat:parseFloat(e[0]),lng:parseFloat(e[1])};return n})}],sensorTypes:["sensor",function(t){return t.callAPI().then(function(t){return t=t.plain()})}],markers:["$state","device","location","utils","Kit","Marker",function(t,e,n,a,o,s){var i=e.getWorldMarkers();return i.length?i:e.getAllDevices().then(function(t){return _.chain(t).map(function(t){return new s(t)}).filter(function(t){return!!t.lng&&!!t.lat}).tap(function(t){e.setWorldMarkers(t)}).value()})}]}}).state("layout.home.kit",{url:"/:id",views:{"container@layout.home":{templateUrl:"app/components/kit/kit.html",controller:"KitController",controllerAs:"vm"}},resolve:{kitData:["$stateParams","device","marker","FullKit","animation",function(t,e,n,a){var o=t.id;return e.getDevice(o).then(function(t){return new a(t)})}],mainSensors:["kitData","sensorTypes",function(t,e){return console.log("main",t),t.getSensors(e,{type:"main"})}],compareSensors:["kitData","sensorTypes",function(t,e){return console.log("compare",t),t.getSensors(e,{type:"compare"})}],ownerKits:["kitData","PreviewKit","$q","device",function(t,e,n,a){var o=t.owner.kits;return console.log("owner",o),n.all(o.map(function(t){return a.getDevice(t).then(function(t){return new e(t)})}))}],belongsToUser:["$window","$stateParams","auth","AuthUser","kitUtils","userUtils",function(t,e,n,a,o,s){if(!n.isAuth())return!1;var i=parseInt(e.id),r=n.getCurrentUser().data||t.localStorage.getItem("smartcitizen.data")&&new a(JSON.parse(t.localStorage.getItem("smartcitizen.data"))),l=o.belongsToUser(r.kits,i),c=s.isAdmin(r);return c||l}]}}).state("layout.userProfile",{url:"/users/:id",templateUrl:"app/components/userProfile/userProfile.html",controller:"UserProfileController",controllerAs:"vm",resolve:{isCurrentUser:["$stateParams","$location","auth",function(t,e,n){if(n.isAuth()){var a=parseInt(t.id),o=n.getCurrentUser().data&&n.getCurrentUser().data.id;a===o&&e.path("/profile")}}],userData:["$stateParams","$state","NonAuthUser","user",function(t,e,n,a){var o=t.id;return a.getUser(o).then(function(t){return new n(t)})}],kitsData:["$q","device","PreviewKit","userData",function(t,e,n,a){var o=_.pluck(a.kits,"id");return o.length?t.all(o.map(function(t){return e.getDevice(t).then(function(t){return new n(t)})})):[]}],isAdmin:["$window","$location","$stateParams","auth","AuthUser",function(t,e,n,a,o){var s=a.getCurrentUser().data&&a.getCurrentUser().data.role||t.localStorage.getItem("smartcitizen.data")&&new o(JSON.parse(t.localStorage.getItem("smartcitizen.data"))).role;if("admin"!==s)return!1;var i=n.id;e.path("/profile/"+i)}]}}).state("layout.myProfile",{url:"/profile",authenticate:!0,templateUrl:"app/components/myProfile/myProfile.html",controller:"MyProfileController",controllerAs:"vm",resolve:{userData:["$location","$window","user","auth","AuthUser",function(t,e,n,a,o){var s=a.getCurrentUser().data||e.localStorage.getItem("smartcitizen.data")&&new o(JSON.parse(e.localStorage.getItem("smartcitizen.data")));if(s)return s}],kitsData:["$q","device","PreviewKit","userData",function(t,e,n,a){var o=_.pluck(a.kits,"id");return o.length?t.all(o.map(function(t){return e.getDevice(t).then(function(t){return new n(t)})})):[]}]}}).state("layout.myProfileAdmin",{url:"/profile/:id",authenticate:!0,templateUrl:"app/components/myProfile/myProfile.html",controller:"MyProfileController",controllerAs:"vm",resolve:{isAdmin:["$window","auth","$location","AuthUser",function(t,e,n,a){var o=e.getCurrentUser().data&&e.getCurrentUser().data.role||t.localStorage.getItem("smartcitizen.data")&&new a(JSON.parse(t.localStorage.getItem("smartcitizen.data"))).role;return"admin"===o?!0:void n.path("/")}],userData:["$stateParams","user","auth","AuthUser",function(t,e,n,a){var o=t.id;return e.getUser(o).then(function(t){return new a(t)})}],kitsData:["$q","device","PreviewKit","userData",function(t,e,n,a){var o=_.pluck(a.kits,"id");return o.length?t.all(o.map(function(t){return e.getDevice(t).then(function(t){return new n(t)})})):[]}]}}).state("layout.login",{url:"/login",authenticate:!1,resolve:{buttonToClick:["$location","isAuth",function(t,e){return e?t.path("/"):(t.path("/kits/667"),void t.search("login","true"))}]}}).state("layout.signup",{url:"/signup",authenticate:!1,resolve:{buttonToClick:["$location","isAuth",function(t,e){return e?t.path("/"):(t.path("/kits/667"),void t.search("signup","true"))}]}}).state("logout",{url:"/logout",authenticate:!0,resolve:{logout:["$location","$state","auth","$rootScope",function(t,e,n,a){n.logout(),t.path("/"),a.$broadcast("loggedOut")}]}}).state("passwordRecovery",{url:"/password_recovery",authenticate:!1,templateUrl:"app/components/passwordRecovery/passwordRecovery.html",controller:"PasswordRecoveryController",controllerAs:"vm"}).state("passwordReset",{url:"/password_reset/:code",authenticate:!1,templateUrl:"app/components/passwordReset/passwordReset.html",controller:"PasswordResetController",controllerAs:"vm"}),e.otherwise("/"),n.html5Mode({enabled:!0,requireBase:!1}).hashPrefix("!"),a.setBaseUrl("https://new-api.smartcitizen.me/v0")
}angular.module("app").config(t),t.$inject=["$stateProvider","$urlRouterProvider","$locationProvider","RestangularProvider"]}(),function(){"use strict";function t(t,e,n,a,o,s,i){t.$on("$stateChangeStart",function(t,n){return console.log("state change"),n.authenticate===!1&&a.isAuth()?(t.preventDefault(),void e.go("landing")):(n.authenticate&&(a.isAuth()||(t.preventDefault(),e.go("landing"))),i.hideAlert(),void(a.reloading()||s.scrollTo(0,0)))}),n.addFullRequestInterceptor(function(t,e,n,o,s,i,r){if(a.isAuth()){var l=a.getCurrentUser().token;s.Authorization="Bearer "+l}return{element:t,headers:s,params:i,httpConfig:r}})}angular.module("app").run(t),t.$inject=["$rootScope","$state","Restangular","auth","$templateCache","$window","animation"]}(),angular.module("app").run(["$templateCache",function(t){t.put("app/components/alert/alerterror.html",'<md-toast class="red"><md-icon md-svg-src="./assets/images/alert_icon.svg" alt="Insert Drive Icon" class="alert_icon"></md-icon><span flex="">{{ vm.message }}</span><md-button ng-click="vm.close()"><md-icon md-svg-src="./assets/images/close_icon_black.svg" alt="Insert Drive Icon" class="close_icon"></md-icon></md-button></md-toast>'),t.put("app/components/alert/alertinfo.html",'<md-toast class="yellow"><md-icon md-svg-src="./assets/images/alert_icon.svg" alt="Insert Drive Icon" class="alert_icon"></md-icon><span flex="">{{ vm.message }}</span><md-button ng-click="vm.close()"><md-icon md-svg-src="./assets/images/close_icon_black.svg" alt="Insert Drive Icon" class="close_icon"></md-icon></md-button></md-toast>'),t.put("app/components/alert/alertsuccess.html",'<md-toast class="green"><md-icon md-svg-src="./assets/images/alert_icon.svg" alt="Insert Drive Icon" class="alert_icon"></md-icon><span flex="">{{ vm.message }}</span><md-button ng-click="vm.close()"><md-icon md-svg-src="./assets/images/close_icon_black.svg" alt="Insert Drive Icon" class="close_icon"></md-icon></md-button></md-toast>'),t.put("app/components/footer/footer.html",'<md-icon md-svg-src="./assets/images/LogotipoSmartCitizen.svg" class="footer_icon"></md-icon>'),t.put("app/components/home/home.html",'<div layout="vertical" layout-fill=""><md-content><section class="content"><section class="map"><h1>Here\'s the map</h1></section><section class="kit_data"><section class="kit_menu" layout="row" layout-align="center center" stick=""><p>Bar with kit info</p></section><section class="kit_fixed" move-down=""><section class="kit_overview" layout="row" layout-align="center center"><p>Kit data overview</p></section><section class="kit_detailed" layout="row" layout-align="center center"><section class="kit_chart"><p>Here it\'s the data</p></section></section></section></section></section></md-content></div>'),t.put("app/components/home/template.html",'<div layout="vertical" layout-fill=""><md-content><section class="content"><div ui-view="map" class="map_state"></div><div ui-view="container" class="kit"></div></section></md-content></div>'),t.put("app/components/kit/kit.html",'<section class="kit_data" change-content-margin=""><section class="kit_menu" layout="row" layout-align="center center" stick=""><div class="container"><div class="kit_user"><md-icon md-svg-src="{{ vm.kit.owner.avatar || \'./assets/images/avatar.svg\'}}"></md-icon><span>{{ vm.kit.owner.username}}</span></div><div class="kit_name"><md-icon md-svg-src="./assets/images/sensor_icon.svg"></md-icon><span>{{ vm.kit.name }}</span></div><div class="kit_battery"><md-icon md-svg-src="{{ vm.battery.icon }}"></md-icon><span>{{ vm.battery.value }} {{ vm.battery.unit }}</span></div><div class="kit_navbar" active-button=""><md-button href="#" class="md-flat chart_icon" aria-label=""><md-icon md-svg-src="./assets/images/chart_icon.svg"></md-icon></md-button><md-button href="#" class="md-flat kit_details_icon" aria-label=""><md-icon md-svg-src="./assets/images/kit_details_icon_light.svg"></md-icon></md-button><md-button href="#" class="md-flat user_details" aria-label=""><md-icon md-svg-src="./assets/images/user_details_icon.svg"></md-icon></md-button></div></div></section><section class="kit_fixed" move-down=""><section class="kit_overview"><md-button ng-click="vm.slide(\'right\')" class="md-flat button_scroll button_scroll_left" layout="column" layout-align="center center" aria-label=""><md-icon md-svg-src="./assets/images/arrow_left_icon.svg"></md-icon></md-button><div class="sensors_container" layout="row" layout-align="center center" horizontal-scroll=""><div ng-repeat="sensor in vm.sensors" class="sensor_container"><md-icon md-svg-src="{{ sensor.icon }}" class="sensor_icon"></md-icon><div class="sensor_value" ng-class="{sensor_value_null: sensor.value === \'N/A\'}">{{ sensor.value }}</div><div class="sensor_right"><div class="sensor_unit">{{ sensor.unit }}</div><md-icon md-svg-src="{{ sensor.arrow }}" class="sensor_arrow"></md-icon></div><div class="clear"></div><div class="sensor_name">{{ sensor.name }}</div></div></div><md-button ng-click="vm.slide(\'left\')" class="md-flat button_scroll button_scroll_right" layout="column" layout-align="center center" aria-label=""><md-icon md-svg-src="./assets/images/arrow_right_icon.svg"></md-icon></md-button></section><section class="kit_detailed"><section class="kit_chart"><div class="container" layout="row"><div class="kit_chart_left"><div class="sensor_select"><md-icon md-svg-src="{{ vm.selectedSensorData.icon }}" class="sensor_icon_selected"></md-icon><md-select placeholder="Choose sensor" ng-model="vm.selectedSensor"><md-option ng-repeat="sensor in vm.sensors" ng-value="{{sensor.id}}" ng-selected="$first"><img class="select_image" src="{{ sensor.icon }}"> <span>{{ sensor.name }}</span></md-option></md-select></div><div class="sensor_data"><span class="sensor_value">{{ vm.selectedSensorData.value }}<span><span class="sensor_unit">{{ vm.selectedSensorData.unit }}</span></span></span></div><div class="sensor_description"><h6>{{ vm.selectedSensorData.name }}</h6><p>{{ vm.selectedSensorData.description }}<a href="#">More info</a></p></div><div class="sensor_compare"><p><span>Compare with</span><md-select placeholder="NONE" ng-model="vm.selectedSensorToCompare"><md-option ng-repeat="sensor in vm.sensorsToCompare" ng-value="{{sensor.id}}"><img class="select_image" src="{{ sensor.icon }}"> <span class="sensor_name">{{ sensor.name }}</span></md-option></md-select></p></div></div><div class="kit_chart_right" flex=""><div class="chart_navigation"><div class="kit_time"><md-icon class="kit_time_icon" md-svg-src="./assets/images/update_icon.svg"></md-icon>{{ vm.kit.time }}</div><div class="picker_container"><label for="picker_from">From:</label> <input type="text" id="picker_from" class="date_picker" placeholder="FROM"></div><div class="picker_container"><label for="picker_to">To:</label> <input type="text" id="picker_to" class="date_picker" placeholder="TO"></div><div class="chart_move"><md-button href="#" ng-click="vm.moveChart(\'left\')" class="chart_move_button chart_move_left" aria-label=""><md-icon md-svg-src="./assets/images/arrow_left_icon.svg"></md-icon></md-button><md-button href="#" ng-click="vm.moveChart(\'right\')" class="chart_move_button chart_move_right" aria-label=""><md-icon md-svg-src="./assets/images/arrow_right_icon.svg"></md-icon></md-button></div></div><div style="clear: both"></div><md-progress-circular ng-show="vm.loadingChart" class="md-hue-3 chart_spinner" md-mode="indeterminate"></md-progress-circular><div chart="" class="chart_container" chart-data="vm.chartDataMain"></div></div></div></section><section class="kit_details"><div class="kit_detailed_content_container"><div class="kit_detailed_title_container"><md-icon class="kit_detailed_icon_title" md-svg-src="./assets/images/kit_details_icon_normal.svg"></md-icon><h2 class="kit_detailed_title">KIT DETAILS</h2></div><div class="kit_detailed_content_container" layout="row"><div class="kit_detailed_avatar"><img ng-src="{{ vm.kit.avatar || \'./assets/images/avatar.svg\' }}"></div><div class="kit_details_content_main" flex=""><div class="kit_details_content"><h3 class="kit_detailed_name kit_details_name">{{ vm.kit.name }}</h3><p class="kit_details_location"><md-icon class="kit_detailed_icon_content" md-svg-src="./assets/images/location_icon_normal.svg"></md-icon><span>{{ vm.kit.location }}</span></p><p class="kit_details_type"><md-icon class="kit_detailed_icon_content" md-svg-src="./assets/images/kit_details_icon_normal.svg"></md-icon><span>{{ vm.kit.type }}</span> <span class="kit_details_version"><span>SCK:</span> {{ vm.kit.version }}</span> <span class="kit_details_id"><span>ID:</span> {{ vm.kit.id }}</span></p><p class="kit_details_lastTime"><md-icon class="kit_detailed_icon_content" md-svg-src="./assets/images/update_icon.svg"></md-icon><span>{{ vm.kit.lastTime }}</span></p><p class="kit_details_labels"><span ng-repeat="label in vm.kit.labels">{{ label }}</span></p><div class="kit_details_description"><h4 class="kit_details_description_title">Kit Description:</h4><p class="kit_details_description_content">{{ vm.kit.description || \'No data\' }}</p></div></div></div><div class="kit_details_manage" ng-if="vm.kitBelongsToUser" flex=""><div class="kit_details_manage_buttons"><md-button href="#" ng-click="" class="kit_details_button_setup" aria-label="">SET UP</md-button><md-button href="#" ng-click="" class="kit_details_button_edit" aria-label="">EDIT</md-button><md-button href="#" ng-click="" class="kit_details_button_delete" aria-label="">DELETE</md-button></div><div class="kit_details_manage_data"><div class="kit_details_macaddress data_container"><md-icon class="kit_detailed_icon_content" md-svg-src="./assets/images/mac_address_icon.svg"></md-icon><span class="kit_details_manage_data_name">Mac Address:</span> <span>00:00:00:00:01</span></div><div class="kit_details_debug data_container"><md-icon class="kit_detailed_icon_content" md-svg-src="./assets/images/debug_icon.svg"></md-icon><span class="kit_details_manage_data_name">Debug mode:</span> <span>Enabled</span></div><div class="kit_details_key" layout="row" layout-align="start center"><md-icon class="kit_detailed_icon_content" md-svg-src="./assets/images/key_icon.svg"></md-icon><span class="kit_details_manage_data_name">API Key:</span><div class="kit_details_key_number">34334324233d3f4f3</div><md-button class="kit_details_key_refreshButton"><md-icon class="" md-svg-src="./assets/images/refresh_icon_white.svg"></md-icon></md-button></div><div class="clearfix"></div><div class="kit_details_download data_container"><md-icon class="kit_detailed_icon_content" md-svg-src="./assets/images/download_icon.svg"></md-icon><span class="kit_details_manage_data_name">Download Data</span> <span>Choose your format</span></div></div></div><div class="kit_details_notAuth" ng-if="!vm.kitBelongsToUser" flex=""><h3 class="kit_details_notAuth_title">People looking for a better city</h3><small class="kit_details_notAuth_subheader">You\'re part of them? Feel free to join us!</small><p class="kit_details_notAuth_description">Smart Citizen is a a platform to generate participatory processes of the people in the cities. Connecting data, people and knowledge, the objective of the platform is to serve as a node for building productive open indicators and distributed tools, and thereafter the collective construction of the city for its own inhabitants.</p><md-button class="kit_details_notAuth_button">GET YOUR KIT AND JOIN US</md-button></div></div></div></section><section class="kit_owner"><div class="kit_detailed_content_container"><div class="kit_detailed_title_container"><md-icon class="kit_detailed_icon_title" md-svg-src="./assets/images/user_details_icon.svg"></md-icon><h2 class="kit_detailed_title">KIT OWNER</h2></div><div class="kit_detailed_content_container"><div class="kit_detailed_avatar"><md-icon md-svg-src="{{ vm.kit.owner.avatar || \'./assets/images/avatar.svg\' }}"></md-icon></div><div class="kit_owner_content"><div class="kit_owner_info"><a href="./users/{{vm.kit.owner.id}}" class="kit_owner_usernameLink"><h3 class="kit_owner_usernameText">{{ vm.kit.owner.username }}</h3></a><p class="kit_owner_location"><md-icon class="kit_detailed_icon_content" md-svg-src="./assets/images/location_icon_normal.svg"></md-icon><span><span ng-if="vm.kit.owner.city">{{ vm.kit.owner.city }}</span> <span ng-if="vm.kit.owner.city && vm.kit.owner.country">,</span> <span ng-if="vm.kit.owner.country">{{ vm.kit.owner.country }}</span> <span ng-if="!vm.kit.owner.city && !vm.kit.owner.country">No location</span></span></p><p class="kit_owner_url"><md-icon class="kit_detailed_icon_content" md-svg-src="./assets/images/url_icon_normal.svg"></md-icon><a ng-href="{{ vm.kit.owner.url }}">{{ vm.kit.owner.url || \'No URL\'}}</a></p></div><div class="kit_owner_kits"><h3 class="kit_owner_kits_title">Kits of {{ vm.kit.owner.username }}</h3><div class="kitList_parent" ng-repeat="kit in vm.ownerKits | limitTo: 5"><md-button ng-href="./kits/{{kit.id}}" class="kitList kitList_secondary" ng-class="{kitList_primary: !vm.kitBelongsToUser, kitList_secondary: vm.kitBelongsToUser, kitList_borderBottom: $last}" layout="row" layout-align="start center"><div class="kitList_container" layout="row" layout-align="start center"><div class=""><img class="kitList_avatar" ng-src="{{ kit.avatar || \'./assets/images/avatar.svg\' }}"></div><div class="kitList_content"><p class="kitList_name">{{ kit.name || \'No name\' }}</p><p class="kitList_data"><md-icon class="kitList_icon" md-svg-src="./assets/images/location_icon_light.svg"></md-icon><span>{{ kit.location || \'No location\' }}</span><md-icon class="kitList_icon" md-svg-src="./assets/images/sensor_icon.svg"></md-icon><span>{{ kit.type }}</span></p></div><div class="kitList_state kitList_state_{{ kit.state.className }}" ng-if="vm.kitBelongsToUser && (kit.state.name === \'never published\' || kit.state.name === \'not configured\')" layout="row" layout-align="center center"><span>{{ kit.state.name }}</span></div></div></md-button><div class="kitList_config" ng-if="vm.kitBelongsToUser"><md-button class="kitList_dropdownButton" dropdown-menu="vm.dropdownOptions" dropdown-model="vm.dropdownSelected" dropdown-item-label="text"><img src="./assets/images/config_icon.svg"></md-button></div></div><md-button ng-href="/users/{{ vm.kit.owner.id }}" ng-if="vm.ownerKits.length > 5" class="kit_owner_kits_more_button" aria-label="">VIEW ALL KITS OF {{ vm.kit.owner.username }}</md-button></div></div></div></div><div class="clearfix"></div></section></section></section></section>'),t.put("app/components/layout/layout.html",'<div class="navbar_container"><md-toolbar layout="row" layout-align="end center" class="stickNav"><a href="/" class="logo_link"><md-icon md-svg-src="./assets/images/LogotipoSmartCitizen.svg" alt="Insert Drive Icon" class="logo_icon"></md-icon></a><section layout="row" class="nav_left" layout-align="space-around center"><md-button ng-show="vm.isShown" href="/" class="md-flat full_height map"><md-icon md-svg-src="./assets/images/map_icon.svg" class="nav_icon"></md-icon><span>Map</span></md-button><md-button ng-show="vm.isShown" href="" class="md-flat full_height community" aria-label="" dropdown-menu="vm.dropdownOptionsCommunity" dropdown-model="vm.dropdownSelectedCommunity" dropdown-item-label="text" layout="row" layout-align="center center"><md-icon md-svg-src="./assets/images/community_icon.svg" class="nav_icon"></md-icon><span>Community</span></md-button></section><search flex=""></search><section layout="row" class="nav_right" layout-align="{{vm.navRightLayout}}"><md-button ng-show="vm.isShown" href="#" class="md-flat full_height get" ng-class="{navbar_highlight_button: vm.isLoggedin}">Get your Kit</md-button><div ng-show="vm.isShown && !vm.isLoggedin" login="" class="navbar_login_button md-display-1"></div><div ng-show="vm.isShown && !vm.isLoggedin" signup="" class="navbar_signup_button md-display-1"></div><md-button ng-show="vm.isShown && vm.isLoggedin" class="md-flat navbar_avatar_button" aria-label="" dropdown-menu="vm.dropdownOptions" dropdown-model="vm.dropdownSelected" dropdown-item-label="text"><md-icon class="navbar_avatar_icon" md-svg-src="{{ vm.currentUser.avatar || \'./assets/images/avatar.svg\' }}"></md-icon></md-button></section></md-toolbar></div><div ui-view=""></div><footer class="footer" ng-include="\'app/components/footer/footer.html\'" layout="row" layout-align="center center"></footer>'),t.put("app/components/login/login.html",'<md-button class="md-flat full_height" ng-click="showLogin($event)">Log In</md-button>'),t.put("app/components/login/loginModal.html",'<md-dialog><md-dialog-content class="modal modal_login"><md-progress-circular ng-show="waitingFromServer" class="md-hue-3 login_spinner" md-mode="indeterminate"></md-progress-circular><md-button class="close_icon"><md-icon md-svg-icon="./assets/images/close_icon_blue.svg" ng-click="hide()" class=""></md-icon></md-button><form name="login_form" novalidate="" ng-submit="answer(vm.user)"><div class="modal_content_container"><h2>LOG IN</h2><div class="modal_message"><p class="header">People looking for a better city</p><p class="subheader">You\'re part of them? Feel free to join us!</p></div><div layout="" layout-sm="column" class="field"><md-input-container flex=""><label>Username</label> <input id="autofocus" type="text" name="username" ng-model="vm.user.username" focus-input="" ng-required="login_form.$submitted"></md-input-container><p class="errors" ng-show="login_form.$submitted || login_form.username.$touched"><span ng-show="login_form.username.$error.required">Username is required</span></p></div><div layout="" layout-sm="column" class="field"><md-input-container flex=""><label>Password</label> <input type="password" name="password" ng-model="vm.user.password" ng-required="login_form.$submitted"></md-input-container><p class="errors" ng-show="login_form.$submitted || login_form.password.$touched"><span ng-show="login_form.password.$error.required">Password is required</span></p></div></div><md-button class="md-flat md-primary main" type="submit">LOG IN</md-button></form></md-dialog-content><p class="message_below"><span><span class="message_below_question">New here?</span><md-button class="message_below_link" ng-click="openSignup()">SIGN UP</md-button></span> <span><span class="message_below_question">Forgot your password?</span><md-button class="message_below_link" ng-click="openPasswordRecovery()">REQUEST</md-button></span></p></md-dialog>'),t.put("app/components/map/map.html",'<section class="map" change-map-height=""><leaflet center="vm.center" layers="vm.layers" markers="vm.markers" defaults="vm.defaults" event-broadcast="vm.events" width="100%" height="100%"></leaflet><div class="map_legend" layout="row" layout-align="start center"><md-button ng-click="vm.openFilterPopup()" class="map_filter_button" layout="row" layout-align="center center" aria-label=""><md-icon md-svg-src="./assets/images/filter_icon.svg"></md-icon></md-button><div class="map_filters"><div ng-repeat="(filterName, isFilterSelected) in vm.filterData" class="map_filter" ng-if="isFilterSelected && !vm.allFiltersSelected" layout="row" layout-align="center center"><span class="map_filter_name">{{ filterName }}</span> <button ng-click="vm.removeFilter(filterName)" class="map_filter_icon" arial-label=""><md-icon md-svg-src="./assets/images/close_icon_black.svg"></md-icon></button></div><div ng-if="vm.allFiltersSelected" class="map_filter" layout="row" layout-align="center center"><span class="map_filter_name">ALL FILTERS</span></div></div></div></section>'),t.put("app/components/map/mapFilterPopup.html",'<md-dialog><md-dialog-content class="modal modal_mapFilter"><md-button class="close_icon"><md-icon md-svg-icon="./assets/images/close_icon_blue.svg" ng-click="cancel()" class=""></md-icon></md-button><div class="modal_content_container_filter"><h2>FILTERS</h2><div class="modal_message"><p class="message">You can apply some filters to get more accurate results on the map.</p></div><div class="input_filter"><h3>Location filter</h3><small>now showing <span ng-show="form.indoor">Indoor</span><span ng-show="form.indoor && form.outdoor">,</span><span ng-show="form.outdoor">Outdoor</span></small><div class="modal_mapFilter_input"><md-checkbox ng-change="applyFilterRules()" ng-model="form.indoor" aria-label=""></md-checkbox><span>Indoor</span></div><div class="modal_mapFilter_input"><md-checkbox ng-change="applyFilterRules()" ng-model="form.outdoor" aria-label=""></md-checkbox><span>Outdoor</span></div></div><md-divider></md-divider><div class="input_filter"><h3>Status filter</h3><small>now showing <span ng-show="form.online">Online</span><span ng-show="form.online && form.offline">,</span><span ng-show="form.offline">Offline</span></small><div class="modal_mapFilter_input"><md-checkbox ng-change="applyFilterRules()" ng-model="form.online" aria-label=""></md-checkbox><span>Online</span></div><div class="modal_mapFilter_input"><md-checkbox ng-change="applyFilterRules()" ng-model="form.offline" aria-label=""></md-checkbox><span>Offline</span></div></div><md-divider></md-divider></div><md-button class="md-flat button_clear" ng-click="answer()">CLEAR FILTERS</md-button><md-button class="md-flat md-primary main" ng-click="answer(form)">APPLY</md-button></md-dialog-content></md-dialog>'),t.put("app/components/myProfile/myProfile.html",'<section class="myProfile_state"><div class="profile_header myProfile_header"><div class="myProfile_header_container" layout="row"><img ng-src="{{ vm.user.avatar || \'./assets/images/avatar.svg\' }}" class="profile_header_avatar myProfile_header_avatar"><div class="profile_header_content"><div class="profile_header_name">{{ vm.user.username || \'No data\' }}</div><div class="profile_header_location"><md-icon md-svg-src="./assets/images/location_icon_light.svg" class="profile_header_content_avatar"></md-icon><span><span ng-if="vm.user.city">{{ vm.user.city }}</span> <span ng-if="vm.user.city && vm.user.country">,</span> <span ng-if="vm.user.country">{{ vm.user.country }}</span> <span ng-if="!vm.user.city && !vm.user.country">No data</span></span></div><div class="profile_header_url"><md-icon md-svg-src="./assets/images/url_icon_light.svg" class="profile_header_content_avatar"></md-icon><a ng-href="{{ vm.user.url || \'http://example.com\' }}">{{ vm.user.url || \'No data\' }}</a></div></div></div></div><div class="myProfile_tabs_parent"><md-tabs class="myProfile_tabs" md-center-tabs="true" md-selected="vm.selectedTab"><md-tab label="" md-on-select="vm.highlightIcon(0)"><md-tab-label><md-icon md-svg-src="./assets/images/user_details_icon.svg" class="myProfile_tab_icon"></md-icon><span>PROFILE</span></md-tab-label><md-tab-body><div class="profile_content" layout="row"><div class="profile_sidebar"><p class="profile_sidebar_title">EDIT YOUR PROFILE</p><p class="profile_sidebar_description">A complete profile helps us to bring to you a better experience. Please, take your time completing all fields.</p><md-button ng-click="" class="profile_sidebar_button myProfile_sidebar_button"><md-icon md-svg-src="./assets/images/support_icon_blue.svg" class="profile_sidebar_avatar"></md-icon><span>Support</span></md-button><md-button ng-click="" class="profile_sidebar_button myProfile_sidebar_button"><md-icon md-svg-src="./assets/images/community_icon_blue.svg" class="profile_sidebar_avatar"></md-icon><span>Community</span></md-button></div><div class="profile_content_main" flex=""><div class="myProfile_content_form"><form ng-submit="vm.updateUser(vm.formUser)"><div class="myProfile_form_avatar" layout="row" layout-align="start center"><img ng-src="{{ vm.user.avatar || \'./assets/images/avatar.svg\' }}" class="myProfile_form_avatarImage"><md-button class="myProfile_form_avatarButton" ngf-select="" ngf-change="vm.uploadAvatar($files)">CHANGE AVATAR</md-button></div><div layout="" layout-sm="column" class="field myProfile_content_form_input"><md-input-container flex=""><label>Username</label> <input type="text" ng-model="vm.formUser.username"></md-input-container><p class="myProfile_updateForm_error" ng-show="!!vm.errors.username.length"><span ng-repeat="error in vm.errors.username">Username {{ error }}<span ng-if="!$last">,</span></span></p></div><div layout="" layout-sm="column" class="field myProfile_content_form_input"><md-input-container flex=""><label>Password</label> <input type="password" ng-model="vm.formUser.password"></md-input-container><p class="myProfile_updateForm_error" ng-show="!!vm.errors.password.length"><span ng-repeat="error in vm.errors.password">Password {{ error }}<span ng-if="!$last">,</span></span></p></div><div layout="" layout-sm="column" class="field myProfile_content_form_input"><md-input-container flex=""><label>Email</label> <input type="email" ng-model="vm.formUser.email"></md-input-container><p class="myProfile_updateForm_error" ng-show="!!vm.errors.email.length"><span ng-repeat="error in vm.errors.email">Email {{ error }}<span ng-if="!$last">,</span></span></p></div><div layout="" layout-sm="column" class="field myProfile_content_form_input"><md-input-container flex=""><label>City</label> <input type="text" ng-model="vm.formUser.city"></md-input-container><p class="myProfile_updateForm_error" ng-show="!!vm.errors.city.length"><span ng-repeat="error in vm.errors.city">City {{ error }}<span ng-if="!$last">,</span></span></p></div><div layout="" layout-sm="column" class="field myProfile_content_form_input"><md-input-container class="countryInput_container" flex=""><label>Country</label><md-autocomplete md-search-text="vm.searchText" md-items="item in vm.getCountries(vm.searchText)" md-item-text="item" md-selected-item="vm.formUser.country" md-floating-label="Favorite state">> <span>{{ item }}</span></md-autocomplete></md-input-container><p class="myProfile_updateForm_error" ng-show="!!vm.errors.country.length"><span ng-repeat="error in vm.errors.country">Country {{ error }}<span ng-if="!$last">,</span></span></p></div><div layout="" layout-sm="column" class="field myProfile_content_form_input"><md-input-container flex=""><label>Website</label> <input type="text" ng-model="vm.formUser.url"></md-input-container><p class="myProfile_updateForm_error" ng-show="!!vm.errors.url.length"><span ng-repeat="error in vm.errors.url">URL {{ error }}<span ng-if="!$last">,</span></span></p></div><md-button type="submit" class="myProfile_form_updateButton">UPDATE PROFILE</md-button></form><div class="clearfix"></div><div class="myProfile_apiKey" layout="row" layout-align="start center"><md-icon md-svg-src="./assets/images/key_icon.svg" class="myProfile_tab_icon"></md-icon><span class="myProfile_apiKey_text">API Key:</span><div class="myProfile_apiKey_number">{{ vm.user.key }}</div><md-button class="myProfile_apiKey_refreshButton md-flat" type="button"><md-icon md-svg-src="./assets/images/refresh_icon_white.svg" class="profile_sidebar_avatar"></md-icon></md-button></div><div class="clearfix"></div><md-button ng-click="vm.removeUser()" class="myProfile_form_removeButton" type="button">DELETE ACCOUNT</md-button><small>Delete your profile will erase all your data. Please consider think twice before click this button.</small></div></div></div></md-tab-body></md-tab><md-tab label="" md-on-select="vm.highlightIcon(1)"><md-tab-label><md-icon md-svg-src="./assets/images/kit_details_icon_light.svg" class="myProfile_tab_icon"></md-icon><span>KITS</span></md-tab-label><md-tab-body><div class="profile_content" layout="row"><div class="profile_sidebar"><p class="profile_sidebar_title">FILTER KITS BY</p><div class="profile_sidebar_options"><md-button ng-click="vm.filterKits(\'all\')" class="profile_sidebar_button">ALL</md-button><md-button ng-click="vm.filterKits(\'online\')" class="profile_sidebar_button">ONLINE</md-button><md-button ng-click="vm.filterKits(\'offline\')" class="profile_sidebar_button">OFFLINE</md-button></div></div><div class="profile_content_main" flex=""><div class="profile_content_main_top"><md-button class="myProfile_addKitButton">ADD A NEW KIT</md-button><span class="myProfile_content_main_title">{{ vm.filteredKits.length || 0 }} kits filtering by {{ vm.kitStatus.toUpperCase() || \'ALL\' }}</span></div><div class="kitList_parent" ng-repeat="kit in (vm.filteredKits = (vm.kits | filterLabel:vm.kitStatus ))"><md-button ng-href="./kits/{{kit.id}}" class="kitList kitList_secondary" ng-class="{kitList_borderBottom: $last}"><div class="kitList_container" layout="row" layout-align="start center"><div class=""><img class="kitList_avatar" ng-src="{{ kit.avatar || \'./assets/images/avatar.svg\' }}"></div><div class="kitList_content"><div class="kitList_name">{{ kit.name || \'No name\' }}</div><div class="kitList_data"><md-icon class="kitList_icon" md-svg-src="./assets/images/location_icon_light.svg"></md-icon><span>{{ kit.location || \'No location\' }}</span><md-icon class="kitList_icon" md-svg-src="./assets/images/sensor_icon.svg"></md-icon><span>{{ kit.type }}</span></div></div><div class="kitList_state kitList_state_{{ kit.state.className }}" ng-if="kit.state.name === \'never published\' || kit.state.name === \'not configured\'">{{ kit.state.name }}</div></div></md-button><div class="kitList_config" layout="row"><md-button class="kitList_dropdownButton" dropdown-menu="vm.dropdownOptions" dropdown-model="vm.dropdownSelected" dropdown-item-label="text"><img src="./assets/images/config_icon.svg"></md-button></div></div><div class="kitList kitList_primary kitList_borderBottom" ng-show="!vm.kits.length"><div class="kitList_container"><div class="kitList_noKits"><span>There are not kits yet</span></div></div></div></div></div></md-tab-body></md-tab><md-tab label="" md-on-select="vm.highlightIcon(2)"><md-tab-label><md-icon md-svg-src="./assets/images/support_icon_white.svg" class="myProfile_tab_icon"></md-icon><span>TOOLS</span></md-tab-label><md-tab-body><div class="profile_content" layout="row"><div class="profile_sidebar"><p class="profile_sidebar_title">FILTER TOOLS BY</p><div class="profile_sidebar_options"><md-button ng-click="vm.filterTools(\'all\')" class="profile_sidebar_button">ALL</md-button><md-button ng-click="vm.filterTools(\'documentation\')" class="profile_sidebar_button">DOCUMENTATION</md-button><md-button ng-click="vm.filterTools(\'community\')" class="profile_sidebar_button">COMMUNITY</md-button><md-button ng-click="vm.filterTools(\'social\')" class="profile_sidebar_button">SOCIAL</md-button></div></div><div class="profile_content_main" flex=""><div class="profile_content_main_top"><span class="profile_content_main_title">{{ vm.filteredTools.length || 0 }} kits filtering by {{ vm.toolType.toUpperCase() || \'ALL\' }}</span></div><div class="profile_content_main_kits"><div ng-repeat="tool in (vm.filteredTools = (vm.tools | filter: { type: vm.toolType } ))" ng-class="{kitList_borderBottom: $last}"><md-button ng-href="{{tool.href}}" class="kitList kitList_primary" layout="row" layout-align="start center"><div class="kitList_container" layout="row" layout-align="start center"><div class=""><md-icon class="kitList_avatar" md-svg-src="{{ tool.avatar || \'./assets/images/user_details_icon.svg\'}}"></md-icon></div><div class="kitList_content"><div class="kitList_name">{{ tool.title }}</div><div class="kitList_data"><span>{{ tool.description }}</span></div></div></div></md-button></div></div></div></div></md-tab-body></md-tab></md-tabs></div></section>'),t.put("app/components/passwordRecovery/passwordRecovery.html",'<header class="footer" ng-include="\'app/components/footer/footer.html\'" layout="row" layout-align="center center"></header><form name="recovery_form" ng-submit="vm.recoverPassword()" novalidate="" class="form_container recovery_container"><div class="form_contentContainer"><h2 class="form_title">FORGOT YOUR PASSWORD?</h2><div class="form_messageContainer"><p class="form_messageHeader">People looking for a better city</p><p class="form_messageSubheader">You\'re part of them? Feel free to join us!</p><p class="form_messageDescription">Please insert your email address and you will receive an email in your inbox. If you do not receive an email from our team in 10 minutes approx., please check your spam folder.</p></div><div layout="" layout-sm="column" class="formRecovery_field"><md-input-container flex=""><label>Username</label> <input type="text" name="username" ng-model="vm.username" autofocus="" ng-required="recovery_form.$submitted"></md-input-container><p class="form_errors formRecovery_errors" ng-show="vm.errors"><span ng-show="recovery_form.username.$error.required">Valid Username or Email is required</span></p></div></div><md-progress-circular ng-show="vm.waitingFromServer" class="md-hue-3 login_spinner" md-mode="indeterminate"></md-progress-circular><md-button type="submit" class="md-flat md-primary form_button">REQUEST NEW PASSWORD</md-button></form>'),t.put("app/components/passwordRecovery/passwordRecoveryModal.html",'<md-dialog><md-dialog-content class="modal modal_recovery"><md-progress-circular ng-show="waitingFromServer" class="md-hue-3 login_spinner" md-mode="indeterminate"></md-progress-circular><md-button class="close_icon"><md-icon md-svg-icon="./assets/images/close_icon_blue.svg" ng-click="hide()" class=""></md-icon></md-button><form name="recovery_form" novalidate="" ng-submit="recoverPassword()"><div class="modal_content_container"><h2>FORGOT YOUR PASSWORD?</h2><div class="modal_message"><p class="header">People looking for a better city</p><p class="subheader">You\'re part of them? Feel free to join us!</p><p class="message">Please insert your email address and you will receive an email in your inbox. If you do not receive an email from our team in 10 minutes approx., please check your spam folder.</p></div><div layout="" layout-sm="column" class="field"><md-input-container flex=""><label>Username or Email</label> <input type="text" name="input" ng-model="input" focus-input="" ng-required="recovery_form.$submitted"></md-input-container><p class="errors" ng-show="errors"><span ng-show="recovery_form.input.$error.required">Valid Username or Email is required</span></p></div></div><md-button class="md-flat md-primary main" type="submit">REQUEST NEW PASSWORD</md-button></form></md-dialog-content><p class="message_below"><span><span class="message_below_question">New here?</span><md-button class="message_below_link" ng-click="openSignup()">SIGN UP</md-button></span></p></md-dialog>'),t.put("app/components/passwordReset/passwordReset.html",'<header class="footer" ng-include="\'app/components/footer/footer.html\'" layout="row" layout-align="center center"></header><form name="form" novalidate="" ng-submit="vm.answer(vm.form)" class="form_container recovery_container"><div class="form_contentContainer"><h2 class="form_title">ENTER YOUR NEW PASSWORD</h2><div class="form_messageContainer"><p class="form_messageHeader">People looking for a better city</p><p class="form_messageSubheader">You\'re part of them? Feel free to join us!</p></div><div layout="" layout-sm="column" class="formReset_field"><md-input-container flex=""><label>New Password</label> <input type="password" name="newPassword" ng-model="vm.form.newPassword" autofocus="" ng-required="form.$submitted"></md-input-container><p class="form_errors formReset_errors" ng-show="form.$submitted || form.newPassword.$touched"><span ng-show="form.newPassword.$error.required">Password is required</span></p></div><div layout="" layout-sm="column" class="formReset_field"><md-input-container flex=""><label>Confirm Password</label> <input type="password" name="password" ng-model="vm.form.confirmPassword" ng-required="form.$submitted"></md-input-container><p class="form_errors formReset_errors" ng-show="form.$submitted || form.password.$touched"><span ng-show="form.password.$error.required">Password is required</span> <span ng-show="vm.isDifferent && !form.password.$error.required && !vm.errors.password.length">It must be the same password</span> <span ng-show="!!vm.errors.password.length"><span ng-repeat="error in vm.errors.password">Password {{ error }}<span ng-if="!$last">,</span></span></span></p></div></div><md-button class="md-flat md-primary form_button" type="submit">RESET PASSWORD</md-button></form>'),t.put("app/components/search/search.html",'<div class="search_icon"><md-icon md-svg-src="./assets/images/search_icon_white.svg" ng-show="vm.isIconWhite"></md-icon><md-icon md-svg-src="./assets/images/search_icon_black.svg" ng-show="!vm.isIconWhite"></md-icon></div><md-autocomplete md-selected-item="vm.selectedItem" md-selected-item-change="vm.selectedItemChange(item)" md-search-text="vm.searchText" md-search-text-change="vm.searchTextChange(vm.searchText)" md-items="item in vm.querySearch(vm.searchText)" md-item-text="" placeholder="Search" md-delay="400" focus=""><md-item-template><md-icon md-svg-src="{{ item.image }}" class="result_icon"></md-icon><span class="result_name">{{ item.name }}</span> <span class="result_location">{{ item.location }}</span></md-item-template></md-autocomplete>'),t.put("app/components/signup/signup.html",'<md-button class="md-icon-button" ng-click="vm.showSignup($event)">Sign Up</md-button>'),t.put("app/components/signup/signupModal.html",'<md-dialog><md-dialog-content class="modal signup"><md-progress-circular ng-show="waitingFromServer" class="md-hue-3 login_spinner" md-mode="indeterminate"></md-progress-circular><md-button class="close_icon"><md-icon md-svg-icon="./assets/images/close_icon_blue.svg" ng-click="cancel()" class=""></md-icon></md-button><form name="form" novalidate="" ng-submit="vm.answer(vm.form)"><div class="modal_content_container"><h2>SIGN UP</h2><div class="modal_message"><p class="header">People looking for a better city</p><p class="subheader">You\'re part of them? Feel free to join us!</p></div><div layout="" layout-sm="column" class="field"><md-input-container flex=""><label>Username</label> <input type="text" ng-model="vm.user.username" focus-input=""></md-input-container><p class="errors" ng-show="!!errors.username.length"><span ng-repeat="error in errors.username">Username {{ error }}<span ng-if="!$last">,</span></span></p></div><div layout="" layout-sm="column" class="field"><md-input-container flex=""><label>Password</label> <input type="password" ng-model="vm.user.password"></md-input-container><p class="errors" ng-show="!!errors.password.length"><span ng-repeat="error in errors.password">Password {{ error }}<span ng-if="!$last">,</span></span></p></div><div layout="" layout-sm="column" class="field"><md-input-container flex=""><label>Email</label> <input type="email" ng-model="vm.user.email"></md-input-container><p class="errors" ng-show="!!errors.email.length"><span ng-repeat="error in errors.email">Email {{ error }}<span ng-if="!$last">,</span></span></p></div></div><md-button class="md-flat md-primary main" ng-click="answer(vm.user)">Sign up</md-button></form></md-dialog-content><p class="message_below"><span class="message_below_question">Already have an account?</span><md-button class="message_below_link" ng-click="openLogin()">LOG IN</md-button></p></md-dialog>'),t.put("app/components/userProfile/userProfile.html",'<section class="profile_state"><div class="profile_header" layout="row" layout-align="start center"><md-icon md-svg-src="./assets/images/user_details_icon.svg" class="profile_header_avatar"></md-icon><div class="profile_header_content"><div class="profile_header_name">{{ vm.user.username }}</div><div class="profile_header_location"><md-icon md-svg-src="./assets/images/location_icon_light.svg" class="profile_header_content_avatar"></md-icon><span><span ng-if="vm.user.city">{{ vm.user.city }}</span> <span ng-if="vm.user.city && vm.user.country">,</span> <span ng-if="vm.user.country">{{ vm.user.country }}</span> <span ng-if="!vm.user.city && !vm.user.country">No data</span></span></div><div class="profile_header_url"><md-icon md-svg-src="./assets/images/url_icon_light.svg" class="profile_header_content_avatar"></md-icon><a ng-href="{{ vm.user.url || \'http://example.com\' }}">{{ vm.user.url || \'No data\' }}</a></div></div></div><div class="profile_content" layout="row"><div class="profile_sidebar"><p class="profile_sidebar_title">FILTER KITS BY</p><div class="profile_sidebar_options"><md-button ng-click="vm.filterKits(\'all\')" class="profile_sidebar_button">ALL</md-button><md-button ng-click="vm.filterKits(\'online\')" class="profile_sidebar_button">ONLINE</md-button><md-button ng-click="vm.filterKits(\'offline\')" class="profile_sidebar_button">OFFLINE</md-button></div></div><div class="profile_content_main" flex=""><div class="profile_content_main_top"><span class="profile_content_main_title">{{ vm.filteredKits.length || 0 }} kits filtering by {{ vm.status.toUpperCase() || \'ALL\' }}</span></div><div class="profile_content_main_kits"><div class="kitList_parent" ng-repeat="kit in (vm.filteredKits = (vm.kits | filterLabel: vm.status))" ng-class="{kitList_borderBottom: $last}"><md-button class="kitList kitList_primary" ng-href="./kits/{{kit.id}}" layout="row" layout-align="start center"><div class="kitList_container" layout="row" layout-align="start center"><div><img class="kitList_avatar" ng-src="{{ kit.avatar || \'./assets/images/avatar.svg\' }}"></div><div class="kitList_content"><div class="kitList_name">{{ kit.name || \'No name\'}}</div><div class="kitList_data"><md-icon class="kitList_icon" md-svg-src="./assets/images/location_icon_light.svg"></md-icon><span>{{ kit.location || \'No location\'}}</span><md-icon class="kitList_icon" md-svg-src="./assets/images/sensor_icon.svg"></md-icon><span>{{ kit.type }}</span></div></div></div></md-button></div><div class="kitList kitList_primary kitList_borderBottom" ng-show="!vm.kits.length"><div class="kitList_container"><div class="kitList_noKits"><span>There are not kits yet</span></div></div></div></div></div></div></section>')
}]);